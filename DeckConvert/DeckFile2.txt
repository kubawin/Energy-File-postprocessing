VERSION 17
*******************************************************************************
*** TRNSYS input file (deck) generated by TrnsysStudio
*** on środa, luty 07, 2018 at 13:21
*** from TrnsysStudio project: P:\Projekty\Rennovates\WP 02 RTD SIMULATIONS\TRNSYS\_Baseline\Baseline_cluster1.tpf
*** 
*** If you edit this file, use the File/Import TRNSYS Input File function in 
*** TrnsysStudio to update the project. 
*** 
*** If you have problems, questions or suggestions please contact your local 
*** TRNSYS distributor or mailto:software@cstb.fr 
*** 
*******************************************************************************


*******************************************************************************
*** Units 
*******************************************************************************

*******************************************************************************
*** Control cards
*******************************************************************************
* START, STOP and STEP
CONSTANTS 3
START=0
STOP=8760
STEP=0.249999993
SIMULATION 	 START	 STOP	 STEP	! Start time	End time	Time step
TOLERANCES 0.001 0.001			! Integration	 Convergence
LIMITS 3000 30 30				! Max iterations	Max warnings	Trace limit
DFQ 1					! TRNSYS numerical integration solver method
WIDTH 72				! TRNSYS output file width, number of characters
LIST 					! NOLIST statement
					! MAP statement
SOLVER 0 1 1				! Solver statement	Minimum relaxation factor	Maximum relaxation factor
NAN_CHECK 0				! Nan DEBUG statement
OVERWRITE_CHECK 0			! Overwrite DEBUG statement
TIME_REPORT 0			! disable time report
EQSOLVER 0				! EQUATION SOLVER statement
ETRACE START STOP			! EQUATION TRACE statement

* User defined CONSTANTS 


* EQUATIONS "Control"
* 
EQUATIONS 10
Pload1_1 = max(([18,2]-[34,4]),0)
PDEGSmin_1 = 1*0.4*CHP_Pel_1
PDEGSmax_1 = 1*1*CHP_Pel_1
PDEGS_1 = max(Pload1_1,PDEGSmin_1)
PDEGSwlot_1 = min(PDEGSma_1x,PDEGS_1)
wlacznik_1 = GT(Pload1_1,0)*1+(1-GT(Pload1_1,0))*0
wlacznik1_1 = GT(Pload1_1,PDEGSmin_1)*1 + (1-GT(Pload1_1,PDEGSmin_1))*1
wlacznikfinal_1 = min(wlacznik_1,wlacznik_11)
CHP_Pel_1 = 50000
EnElBought_1 = max(0,[18,2]-[34,4]-PDEGSwlot_1) ! electric energy bought from net
*$UNIT_NAME Control
*$LAYER Main
*$POSITION 576 316

*------------------------------------------------------------------------------


* Model "power demand" (Type 9)
* 

UNIT 18 TYPE 9	 power demand
*$UNIT_NAME power demand
*$MODEL .\Utility\Data Readers\Generic Data Files\First Line is Simulation Start\Free Format\Type9a.tmf
*$POSITION 586 167
*$LAYER Main # 
PARAMETERS 18
2		! 1 Mode
1		! 2 Header Lines to Skip
3		! 3 No. of values to read
1		! 4 Time interval of data
1		! 5 Interpolate or not?-1
1000		! 6 Multiplication factor-1
0		! 7 Addition factor-1
1		! 8 Average or instantaneous value-1
1		! 9 Interpolate or not?-2
1000		! 10 Multiplication factor-2
0		! 11 Addition factor-2
1		! 12 Average or instantaneous value-2
1		! 13 Interpolate or not?-3
1000		! 14 Multiplication factor-3
0		! 15 Addition factor-3
1		! 16 Average or instantaneous value-3
86		! 17 Logical unit for input file
-1		! 18 Free format mode
*** External files
ASSIGN "Input\stawki_prad.txt" 86
*|? Input file name |1000
*------------------------------------------------------------------------------

* Model "CHP controller" (Type 102)
* 

UNIT 19 TYPE 102	 CHP controller
*$UNIT_NAME CHP controller
*$MODEL .\Electrical\Diesel Engine (DEGS)\DEGS Dispatch Controller\Type102a.tmf
*$POSITION 1807 106
*$LAYER Main # 
PARAMETERS 5
1		! 1 Minimum number of DEGS in operation
1		! 2 Maximum number of DEGS in operation
250		! 3 DEGS rated power
0.4		! 4 Minimum turndown
1		! 5 Maximum power
INPUTS 1
PDEGSwlot_1		! Control:PDEGSwlot_1 ->Load power
*** INITIAL INPUT VALUES
500000 
*------------------------------------------------------------------------------

* Model "CHP engine" (Type 120)
* 

UNIT 20 TYPE 120	 CHP engine
*$UNIT_NAME CHP engine
*$MODEL .\Electrical\Diesel Engine (DEGS)\Generic Model\Type120a.tmf
*$POSITION 1807 208
*$LAYER Main # 
*$# Generic Model DEGS
PARAMETERS 5
1		! 1 DEGS mode
5		! 2 DEGS fuel type
250		! 3 Maximum DEGS power
10		! 4 Minimum DEGS power
250		! 5 Rated power
INPUTS 3
wlacznikfinal_1		! Control:wlacznikfinal_1 ->DEGS on/off switch
19,1 		! CHP controller:Single DEG power ->DEGS power set point
19,2 		! CHP controller:Number of DEGS in operation ->Number of units on
*** INITIAL INPUT VALUES
1 300000 1 
*------------------------------------------------------------------------------

* EQUATIONS "Heat Production by CHP"
* 
EQUATIONS 4
PthCHP = GT([20,1],0)*(A*[20,1]+B*1000) 
A = 1.6668
B = 5.86345
PthCHPnom = GT(CHP_Pel_1,0)*(A*CHP_Pel_1+B*1000)    
*$UNIT_NAME Heat Production by CHP
*$LAYER Main
*$POSITION 1632 207

*------------------------------------------------------------------------------


* Model "DHW demand" (Type 9)
* 

UNIT 23 TYPE 9	 DHW demand
*$UNIT_NAME DHW demand
*$MODEL .\Utility\Data Readers\Generic Data Files\First Line is Simulation Start\Free Format\Type9a.tmf
*$POSITION 275 181
*$LAYER Main # 
PARAMETERS 10
2		! 1 Mode
1		! 2 Header Lines to Skip
1		! 3 No. of values to read
1		! 4 Time interval of data
1		! 5 Interpolate or not?
1		! 6 Multiplication factor
0		! 7 Addition factor
1		! 8 Average or instantaneous value
87		! 9 Logical unit for input file
-1		! 10 Free format mode
*** External files
ASSIGN "Input\stawki_dhw.txt" 87
*|? Input file name |1000
*------------------------------------------------------------------------------

* EQUATIONS "DHW flow_demand"
* 
EQUATIONS 4
Demand_FR_1 = ((0.001*[23,1])/(4.19*(Tload_1-Tcold_1)))*3600
Tcold_1 = 15
Tload_1 = 60
T_hotNet_1 = 90
*$UNIT_NAME DHW flow_demand
*$LAYER Main
*$POSITION 247 292

*------------------------------------------------------------------------------


* EQUATIONS "Heat _from_CHP"
* 
EQUATIONS 2
TankTempHot_1 = max(GT(PthCHP,0)*(20+[44,1]),[44,1])
TankFR_Hot_1 = [40,2]
*$UNIT_NAME Heat _from_CHP
*$LAYER Main
*$POSITION 128 181

*------------------------------------------------------------------------------


* EQUATIONS "DHW Energy rates"
* 
EQUATIONS 6
EnergyRatFromCHP_1 = 1000*PumpSignal*4.19*[40,2]*(TankTempHot_1-[29,20])/3600
EnergyRatToDHW_1 = 1000*([29,5]+[30,5])/3600 ! dhw energy produced
PumpFR_1 = max(0.7*PumpFRnom_1,(3.6*PthCHP)/(20*4.19))
PumpFRnom_1 = (3.6*PthCHPnom)/(20*4.19)
Pumpsignal_1 = min(1,PumpFR_1/PumpFRnom_1)
CHPTdelta_1 = TankTempHot_1-[29,20]
*$UNIT_NAME DHW Energy rates
*$LAYER Main
*$POSITION 399 243

*------------------------------------------------------------------------------


* Model "CHP_Recirc_pump" (Type 110)
* 

UNIT 40 TYPE 110	 CHP_Recirc_pump
*$UNIT_NAME CHP_Recirc_pump
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 402 141
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
2040		! 1 Rated flow rate
4.19		! 2 Fluid specific heat
2684.0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1		! 6 Power coefficient
INPUTS 5
0,0		! [unconnected] Inlet fluid temperature
0,0		! [unconnected] Inlet fluid flow rate
Pumpsignal_1		! DHW Energy rates:Pumpsignal_1 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
20.0 0.0 1 0.7 0.9 
*------------------------------------------------------------------------------

* EQUATIONS "Spaceheating"
* 
EQUATIONS 1
EnergyRateToDSH_1 = max(0,PthCHP-EnergyRateToDHW)
*$UNIT_NAME Spaceheating
*$LAYER Main
*$POSITION 1632 101

*------------------------------------------------------------------------------


* Model "EnergyMonthly" (Type 46)
* 

UNIT 25 TYPE 46	 EnergyMonthly
*$UNIT_NAME EnergyMonthly
*$MODEL .\Output\Printegrator\Unformatted\User-Defined and Automatic Monthly Periods\Type46b.tmf
*$POSITION 58 969
*$LAYER Main # 
*$# PRINTEGRATOR
PARAMETERS 5
89		! 1 Logical unit
90		! 2 Logical unit for monthly summaries
0		! 3 Relative or absolute start time
24.000001		! 4 Printing & integrating interval
0		! 5 Number of inputs to avoid integration
INPUTS 72
34,4 		! 1_PV-Inverter:Power at maximum power point ->1
20,1 		! CHP engine:Total power delivered ->1
0,0		! [unconnected] 1
0,0		! [unconnected] 1
0,0		! [unconnected] 1
0,0		! [unconnected] 1
0,0		! [unconnected] 1
20,3 		! CHP engine:Gas fuel consumption rate ->1
66,4 		! 1_PV-Inverter-2:Power at maximum power point ->2
0,0		! [unconnected] 2
0,0		! [unconnected] 2
0,0		! [unconnected] 2
0,0		! [unconnected] 2
0,0		! [unconnected] 2
0,0		! [unconnected] 2
0,0		! [unconnected] 2
87,4 		! 1_PV-Inverter-3:Power at maximum power point ->3
0,0		! [unconnected] 3
0,0		! [unconnected] 3
0,0		! [unconnected] 3
0,0		! [unconnected] 3
0,0		! [unconnected] 3
0,0		! [unconnected] 3
0,0		! [unconnected] 3
108,4 		! 1_PV-Inverter-4:Power at maximum power point ->4
0,0		! [unconnected] 4
0,0		! [unconnected] 4
0,0		! [unconnected] 4
0,0		! [unconnected] 4
0,0		! [unconnected] 4
0,0		! [unconnected] 4
0,0		! [unconnected] 4
129,4 		! 1_PV-Inverter-5:Power at maximum power point ->5
0,0		! [unconnected] 5
0,0		! [unconnected] 5
0,0		! [unconnected] 5
0,0		! [unconnected] 5
0,0		! [unconnected] 5
0,0		! [unconnected] 5
0,0		! [unconnected] 5
150,4 		! 1_PV-Inverter-6:Power at maximum power point ->6
0,0		! [unconnected] 6
0,0		! [unconnected] 6
0,0		! [unconnected] 6
0,0		! [unconnected] 6
0,0		! [unconnected] 6
0,0		! [unconnected] 6
0,0		! [unconnected] 6
171,4 		! 1_PV-Inverter-7:Power at maximum power point ->7
0,0		! [unconnected] 7
0,0		! [unconnected] 7
0,0		! [unconnected] 7
0,0		! [unconnected] 7
0,0		! [unconnected] 7
0,0		! [unconnected] 7
0,0		! [unconnected] 7
192,4 		! 1_PV-Inverter-8:Power at maximum power point ->8
0,0		! [unconnected] 8
0,0		! [unconnected] 8
0,0		! [unconnected] 8
0,0		! [unconnected] 8
0,0		! [unconnected] 8
0,0		! [unconnected] 8
0,0		! [unconnected] 8
213,4 		! 1_PV-Inverter-9:Power at maximum power point ->9
0,0		! [unconnected] 9
0,0		! [unconnected] 9
0,0		! [unconnected] 9
0,0		! [unconnected] 9
0,0		! [unconnected] 9
0,0		! [unconnected] 9
0,0		! [unconnected] 9
*** INITIAL INPUT VALUES
1E_PVout 1E_CHPout 1Q_DHWout 1Q_SHout 1Q_DHWin 1Q_SHin 1E_in 1_GASin
2E_PVout 2E_CHPout 2Q_DHWout 2Q_SHout 2Q_DHWin 2Q_SHin 2E_in 2_GASin
3E_PVout 3E_CHPout 3Q_DHWout 3Q_SHout 3Q_DHWin 3Q_SHin 3E_in 3_GASin
4E_PVout 4E_CHPout 4Q_DHWout 4Q_SHout 4Q_DHWin 4Q_SHin 4E_in 4_GASin
5E_PVout 5E_CHPout 5Q_DHWout 5Q_SHout 5Q_DHWin 5Q_SHin 5E_in 5_GASin
6E_PVout 6E_CHPou6 6Q_DHWout 6Q_SHout 6Q_DHWin 6Q_SHin 6E_in 6_GASin
7E_PVout 7E_CHPout 7Q_DHWout 7Q_SHout 7Q_DHWin 7Q_SHin 7E_in 7_GASin
8E_PVout 8E_CHPout 8Q_DHWout 8Q_SHout 8Q_DHWin 8Q_SHin 8E_in 8_GASin
9E_PVout 9E_CHPout 9Q_DHWout 9Q_SHout 9Q_DHWin 9Q_SHin 9E_in 9_GASin

LABELS 8
PVel CHPel QDHout QSHout QDHWin QSHin Elin Gasin
*** External files
ASSIGN "res\Bills.dat" 89
*|? Output file for integrated user-defined period results? |1000
ASSIGN "res\Bills2.dat" 90
*|? Output file for automatic monthly integrated results? |1000
*------------------------------------------------------------------------------

* Model "Temperatures" (Type 65)
* 

UNIT 33 TYPE 65	 Temperatures
*$UNIT_NAME Temperatures
*$MODEL .\Output\Online Plotter\Online Plotter With File\TRNSYS-Supplied Units\Type65a.tmf
*$POSITION 78 234
*$LAYER Main # 
PARAMETERS 12
10		! 1 Nb. of left-axis variables
3		! 2 Nb. of right-axis variables
0.0		! 3 Left axis minimum
100		! 4 Left axis maximum
0.0		! 5 Right axis minimum
1000.0		! 6 Right axis maximum
1		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
91		! 10 Logical Unit for output file
2		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 13
0,0		! [unconnected] Left axis variable-1
29,1 		! AF3000:Temperature at outlet ->Left axis variable-2
44,1 		! DryCooler:Fluid outlet temperature ->Left axis variable-3
0,0		! [unconnected] Left axis variable-4
30,3 		! PreheatFreshWater:Load side outlet temperature ->Left axis variable-5
30,1 		! PreheatFreshWater:Source-side outlet temperature ->Left axis variable-6
32,1 		! Diverter:Temperature at outlet 1 ->Left axis variable-7
46,1 		! SH_HX3:Source-side outlet temperature ->Left axis variable-8
29,20 		! AF3000:Temperature at HX Outlet ->Left axis variable-9
28,1 		! TeePiece:Outlet temperature ->Left axis variable-10
0,0		! [unconnected] Right axis variable-1
0,0		! [unconnected] Right axis variable-2
0,0		! [unconnected] Right axis variable-3
*** INITIAL INPUT VALUES
Tcold_fromNet T_to_DHW Treturn_from_DryCooler_to_CHP Tsource HX1out_toTank
HX1out_to_Diverter Tout_from_Diverter_to_HX2 HX3_Tout_source HX2_Tout_source
TeePiece_Tout LMTD dT1 dT2 
LABELS  3
"Temperatures"
"Heat transfer rates"
"Temperatures"
*** External files
ASSIGN "Temperatures.dat" 91
*|? What file should the online print to? |1000
*------------------------------------------------------------------------------

* Model "FRates" (Type 65)
* 

UNIT 39 TYPE 65	 FRates
*$UNIT_NAME FRates
*$MODEL .\Output\Online Plotter\Online Plotter With File\TRNSYS-Supplied Units\Type65a.tmf
*$POSITION 79 301
*$LAYER Main # 
PARAMETERS 12
6		! 1 Nb. of left-axis variables
3		! 2 Nb. of right-axis variables
0.0		! 3 Left axis minimum
3000		! 4 Left axis maximum
0.0		! 5 Right axis minimum
1		! 6 Right axis maximum
1		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
125		! 10 Logical Unit for output file
2		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 9
0,0		! [unconnected] Left axis variable-1
29,21 		! AF3000:HX flow rate ->Left axis variable-2
30,2 		! PreheatFreshWater:Source side flow rate ->Left axis variable-3
28,2 		! TeePiece:Outlet flow rate ->Left axis variable-4
32,2 		! Diverter:Flow rate at outlet 1 ->Left axis variable-5
32,4 		! Diverter:Flow rate at outlet 2 ->Left axis variable-6
44,8 		! DryCooler:Relative fan speed ->Right axis variable-1
PumpFR_1		! [equation] Right axis variable-2
0,0		! [unconnected] Right axis variable-3
*** INITIAL INPUT VALUES
DHWDemand HX2 HX1 TeePiece DivOut1Tank DivOut2TeePiec FanSpeed PumpFR_1
PumpSignal 
LABELS  3
"Flow Rates"
"Heat transfer rates"
Flow Rates"
*** External files
ASSIGN "FR.dat" 125
*|? What file should the online print to? |1000
*------------------------------------------------------------------------------

* Model "AF3000" (Type 534)
* 

UNIT 29 TYPE 534	 AF3000
*$UNIT_NAME AF3000
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\Coiled Tube HXs\Type534-Coiled.tmf
*$POSITION 516 394
*$LAYER Main # 
*$# Cylindrical Storage Tank
PARAMETERS 60
-1		! 1 LU for data file
5		! 2 Number of tank nodes
1		! 3 Number of ports
1		! 4 Number of immersed heat exchangers
1		! 5 Number of miscellaneous heat flows
3		! 6 Tank volume
1.5		! 7 Tank height
0		! 8 Tank fluid
4.19		! 9 Fluid specific heat
1000		! 10 Fluid density
2.14		! 11 Fluid thermal conductivity
3.21		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
5.0		! 14 Top loss coefficient
5.0		! 15 Edge loss coefficient for node-1
5.0		! 16 Edge loss coefficient for node-2
5.0		! 17 Edge loss coefficient for node-3
5.0		! 18 Edge loss coefficient for node-4
5.0		! 19 Edge loss coefficient for node-5
5.0		! 20 Bottom loss coefficient
0		! 21 Additional thermal conductivity
1		! 22 Inlet flow mode
1		! 23 Entry node
1		! 24 Exit node
3.0		! 25 Flue loss coefficient for node-1
3.0		! 26 Flue loss coefficient for node-2
3.0		! 27 Flue loss coefficient for node-3
3.0		! 28 Flue loss coefficient for node-4
3.0		! 29 Flue loss coefficient for node-5
1		! 30 Node for miscellaneous heat gain
3		! 31 Type of HX
5		! 32 Number of HX nodes
0		! 33 HX fluid
4.19		! 34 HX fluid specific heat
1000		! 35 HX fluid density
2.14		! 36 HX fluid thermal conductivity
3.21		! 37 HX fluid viscosity
0.6		! 38 Multiplier for natural convection
0.25		! 39 Exponent for natural convection
1.0		! 40 Geometry factor for natural convection
1.0		! 41 Geometry exponent for natural convection
0.035		! 42 Inner tube diameter
0.036505		! 43 Outer tube diameter
2.14		! 44 HX wall thermal conductivity
83		! 45 Length of HX tubes
1		! 46 Number of tubes
0		! 47 HX header volume
0.05		! 48 HX cross sectional area
1		! 49 Coil diameter
0.05		! 50 Coil pitch
1		! 51 Tank node for HX node-1
0.2		! 52 Fraction of HX length-1
1		! 53 Tank node for HX node-2
0.2		! 54 Fraction of HX length-2
1		! 55 Tank node for HX node-3
0.2		! 56 Fraction of HX length-3
1		! 57 Tank node for HX node-4
0.2		! 58 Fraction of HX length-4
1		! 59 Tank node for HX node-5
0.2		! 60 Fraction of HX length-5
INPUTS 19
30,3 		! PreheatFreshWater:Load side outlet temperature ->Inlet temperature for port
30,4 		! PreheatFreshWater:Load side flow rate ->Inlet flow rate for port
32,1 		! Diverter:Temperature at outlet 1 ->Inlet temperature for HX
32,2 		! Diverter:Flow rate at outlet 1 ->Inlet flow rate for HX
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Edge loss temperature for node-4
0,0		! [unconnected] Edge loss temperature for node-5
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
0,0		! [unconnected] Auxiliary heat input for node-4
0,0		! [unconnected] Auxiliary heat input for node-5
0,0		! [unconnected] Miscellaneous heat input
*** INITIAL INPUT VALUES
20.0 0.0 20.0 0.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 0.0
0.0 0 
DERIVATIVES 5
20.0		! 1 Initial Tank Temperature-1
20.0		! 2 Initial Tank Temperature-2
20.0		! 3 Initial Tank Temperature-3
20.0		! 4 Initial Tank Temperature-4
20.0		! 5 Initial Tank Temperature-5
*------------------------------------------------------------------------------

* Model "Load_Tout" (Type 22)
* 

UNIT 22 TYPE 22	 Load_Tout
*$UNIT_NAME Load_Tout
*$MODEL .\Controllers\Iterative Feedback Controller\Type22.tmf
*$POSITION 612 167
*$LAYER Main # 
PARAMETERS 2
0		! 1 mode
0		! 2 Maximum number of oscillations
INPUTS 7
Tload_1		! DHW flow_demand:Tload_1 ->Setpoint
29,1 		! AF3000:Temperature at outlet ->Controlled variable
0,0		! [unconnected] On / Off signal
0,0		! [unconnected] Minimum control signal
0,0		! [unconnected] Maximum control signal
0,0		! [unconnected] Threshold for non-zero output
0,0		! [unconnected] Tolerance on tracking error
*** INITIAL INPUT VALUES
58 0 1 0 1 0 0 
*------------------------------------------------------------------------------

* Model "PreheatFreshWater" (Type 91)
* 

UNIT 30 TYPE 91	 PreheatFreshWater
*$UNIT_NAME PreheatFreshWater
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 247 394
*$LAYER Main # 
PARAMETERS 3
0		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
TankTempHot_1		! Heat _from_CHP:TankTempHot_1 ->Source side inlet temperature
TankFR_Hot_1		! Heat _from_CHP:TankFR_Hot_1 ->Source side flow rate
Tcold_1		! DHW flow_demand:Tcold_1 ->Load side inlet temperature
Demand_FR_1		! DHW flow_demand:Demand_FR_1 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "1_PV-Inverter" (Type 194)
* 

UNIT 34 TYPE 194	 1_PV-Inverter
*$UNIT_NAME 1_PV-Inverter
*$MODEL .\Electrical\Photovoltaic Panels\With Inverter\Type194b.tmf
*$POSITION 700 316
*$LAYER Main # 
PARAMETERS 29
2		! 1 Mode
8.63		! 2 Module short-circuit current at reference conditions
37.68		! 3 Module open-circuit voltage at reference conditions
298		! 4 Reference temperature
1000		! 5 Reference insolation
30.93		! 6 Module voltage at max power point and reference conditions
8.08		! 7 Module current at max power point and reference conditions
0.07		! 8 Temperature coeficient of Isc at (ref. cond)
-0.34		! 9 Temperature coeficient of Voc (ref. cond.)
60		! 10 Number of cells wired in series
132		! 11 Number of modules in series
1		! 12 Number of modules in parallel
319		! 13 Module temperature at NOCT
293		! 14 Ambient temperature at NOCT
800		! 15 Insolation at NOCT
1.6		! 16 Module area
0.99		! 17 tau-alpha product for normal incidence
1.12		! 18 Semiconductor bandgap
1.9		! 19 Value of parameter "a" at reference conditions
5.4		! 20 Value of parameter I_L at reference conditions
0		! 21 Value of parametre I_0 at reference conditions
0.5		! 22 Module series resistance
45.81		! 23 Shunt resistance at reference conditions
0.008		! 24 Extinction coefficient-thickness product of cover
40800		! 25 Maximum inverter power
10000		! 26 Maximium inverter voltage
0		! 27 Minimum inverter voltage
0		! 28 Night tare
126		! 29 Logical unit number for inverter data
INPUTS 10
36,24 		! 1:Total tilted surface radiation for surface ->Total incident radiation on tilted surface
36,1 		! 1:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Load voltage
36,30 		! 1:Slope of surface ->Array slope
36,25 		! 1:Beam radiation for surface ->Beam radiation on tilted surface
36,26 		! 1:Sky diffuse radiation for surface ->Sky diffuse radiation on tilted surface
36,27 		! 1:Ground reflected diffuse radiation for surface ->Ground diffuse radiation on tilted surface
36,29 		! 1:Angle of incidence for surface ->Incidence angle on tilted surface
36,16 		! 1:Solar zenith angle ->Solar zenith angle
36,8 		! 1:Wind velocity ->Wind speed
*** INITIAL INPUT VALUES
0 0 0 0 0 0 0 0 0 0 
*** External files
ASSIGN "C:\Dysk Google\CHP model\Type194-inverter.dat" 126
*|? What file contains the inverter parameters? |1000
*------------------------------------------------------------------------------

* Model "1" (Type 15)
* 

UNIT 36 TYPE 15	 1
*$UNIT_NAME 1
*$MODEL .\Weather Data Reading and Processing\Standard Format\TMY2\Type15-2.tmf
*$POSITION 817 314
*$LAYER Main # 
PARAMETERS 9
2		! 1 File Type
127		! 2 Logical unit
5		! 3 Tilted Surface Radiation Mode
0.2		! 4 Ground reflectance - no snow
0.7		! 5 Ground reflectance - snow cover
1		! 6 Number of surfaces
1		! 7 Tracking mode
45		! 8 Slope of surface
0		! 9 Azimuth of surface
*** External files
ASSIGN "C:\TRNSYS17\Weather\Meteonorm\Europe\PL-Warszawa-123750.tm2" 127
*|? Which file contains the TMY-2 weather data? |1000
*------------------------------------------------------------------------------

* Model "DryCooler" (Type 511)
* 

UNIT 44 TYPE 511	 DryCooler
*$UNIT_NAME DryCooler
*$MODEL .\HVAC Library (TESS)\Dry Fluid Cooler\Type511.tmf
*$POSITION 215 594
*$LAYER Main # 
*$# DRY FLUID COOLER
PARAMETERS 11
1		! 1 Heat exchanger mode
70		! 2 Design inlet fluid temperature
60		! 3 Design outlet fluid temperature
5678.12		! 4 Design fluid flow rate
4.190		! 5 Fluid specific heat
28.0		! 6 Design ambient air temperature
5678.12		! 7 Design air flow rate
5369.04		! 8 Rated fan power
10.0		! 9 Ratio of liquid h to air h
1		! 10 Number of power coefficients
1		! 11 Power coefficient
INPUTS 5
46,1 		! SH_HX3:Source-side outlet temperature ->Fluid inlet temperature
46,2 		! SH_HX3:Source side flow rate ->Fluid flow rate
36,1 		! 1:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Fan control signal
0,0		! [unconnected] Desired outlet temperature
*** INITIAL INPUT VALUES
10.0 0.0 20.0 -1 70 
*------------------------------------------------------------------------------

* Model "TeePiece" (Type 11)
* 

UNIT 28 TYPE 11	 TeePiece
*$UNIT_NAME TeePiece
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 689 434
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
29,20 		! AF3000:Temperature at HX Outlet ->Temperature at inlet 1
29,21 		! AF3000:HX flow rate ->Flow rate at inlet 1
32,3 		! Diverter:Temperature at outlet 2 ->Temperature at inlet 2
32,4 		! Diverter:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "Diverter" (Type 11)
* 

UNIT 32 TYPE 11	 Diverter
*$UNIT_NAME Diverter
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 521 487
*$LAYER Water Loop # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
37,3 		! PostHeatCHPout:Load side outlet temperature ->Inlet temperature
37,4 		! PostHeatCHPout:Load side flow rate ->Inlet flow rate
22,1 		! Load_Tout:Control signal ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 1 
*------------------------------------------------------------------------------

* Model "PostHeatCHPout" (Type 91)
* 

UNIT 37 TYPE 91	 PostHeatCHPout
*$UNIT_NAME PostHeatCHPout
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 247 487
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
ThotNet_1		! Substation:ThotNet_1 ->Source side inlet temperature
msource_1		! Substation:msource_1 ->Source side flow rate
30,1 		! PreheatFreshWater:Source-side outlet temperature ->Load side inlet temperature
30,2 		! PreheatFreshWater:Source side flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* EQUATIONS "Substation"
* 
EQUATIONS 4
ThotNet_1 = 90
msource_1 = [37,4]
kWhFromSubstToDHW_1 = [37,5]/3.6 ! dhw energy bought from net
kWhDryCooler_1 = [44,3]/3.6
*$UNIT_NAME Substation
*$LAYER Main
*$POSITION 107 487

*------------------------------------------------------------------------------


* Model "Power" (Type 65)
* 

UNIT 43 TYPE 65	 Power
*$UNIT_NAME Power
*$MODEL .\Output\Online Plotter\Online Plotter With File\TRNSYS-Supplied Units\Type65a.tmf
*$POSITION 52 742
*$LAYER Main # 
PARAMETERS 12
9		! 1 Nb. of left-axis variables
8		! 2 Nb. of right-axis variables
0.0		! 3 Left axis minimum
100000		! 4 Left axis maximum
0.0		! 5 Right axis minimum
100000		! 6 Right axis maximum
1		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
128		! 10 Logical Unit for output file
2		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 17
20,1 		! CHP engine:Total power delivered ->Left axis variable-1
PthCHP		! Heat Production by CHP:PthCHP ->Left axis variable-2
0,0		! [unconnected] Left axis variable-3
EnergyRatToDHW_2		! [equation] Left axis variable-4
kWhDryCooler_2		! [equation] Left axis variable-5
kWhFromSubstToDHW_2		! [equation] Left axis variable-6
34,4 		! 1_PV-Inverter:Power at maximum power point ->Left axis variable-7
18,3 		! power demand:Output 3 ->Left axis variable-8
23,1 		! DHW demand:Output 1 ->Left axis variable-9
0,0		! [unconnected] Right axis variable-1
0,0		! [unconnected] Right axis variable-2
45,1 		! SH demand:Output 1 ->Right axis variable-3
20,3 		! CHP engine:Gas fuel consumption rate ->Right axis variable-4
0,0		! [unconnected] Right axis variable-5
0,0		! [unconnected] Right axis variable-6
0,0		! [unconnected] Right axis variable-7
0,0		! [unconnected] Right axis variable-8
*** INITIAL INPUT VALUES
PelCHP PthCHP SH_rate EnergyRatToDHW_2 kWhDryCooler_2 kWhFromSubstToDHW_2
PVPower Pel_demand DHW_demand Q_HX3_from_sourceSide Q_HX3_toLoad
SH_demand GasConsumption Subst Fuel ElPower TotalEFF 
LABELS  3
"Temperatures"
"Heat transfer rates"
"Graph 1"
*** External files
ASSIGN "res\Power.dat" 128
*|? What file should the online print to? |1000
*------------------------------------------------------------------------------

* EQUATIONS "SH_calc"
* 
EQUATIONS 7
Tin_to_HX3_1 = 55 ! °C
FR_to_HX3_1 = (Q_sh_corr_2)/((max(1,(4.19*(abs(Tset_to_SH_1-Tin_to_HX3_1))))))*3.6 ! delta T is implicit but parameters should be 70/55°C so delta is 15°C
Tset_to_SH_1 = 70 !°C
Q_HX3_1 = [28,2]*4.19*max(0,abs(([28,1] - [46,1])))/3.6
Q_sh_corr_1 = min(Q_HX3_1,[45,1])
SH_HX3_prod_1 = [46,5]/3.6 !kWh/h sh energy produced and used
SH_bought_1 = max(0,[45,1] - SH_HX3_prod_1) !kWh/h sh energy bought
*$UNIT_NAME SH_calc
*$LAYER Main
*$POSITION 626 714

*------------------------------------------------------------------------------


* Model "SH demand" (Type 9)
* 

UNIT 45 TYPE 9	 SH demand
*$UNIT_NAME SH demand
*$MODEL .\Utility\Data Readers\Generic Data Files\First Line is Simulation Start\Free Format\Type9a.tmf
*$POSITION 430 174
*$LAYER Main # 
PARAMETERS 10
2		! 1 Mode
1		! 2 Header Lines to Skip
1		! 3 No. of values to read
1		! 4 Time interval of data
1		! 5 Interpolate or not?
1		! 6 Multiplication factor
0		! 7 Addition factor
1		! 8 Average or instantaneous value
130		! 9 Logical unit for input file
-1		! 10 Free format mode
*** External files
ASSIGN "Input\stawki_sh.txt" 130
*|? Input file name |1000
*------------------------------------------------------------------------------

* Model "SH_HX3" (Type 91)
* 

UNIT 46 TYPE 91	 SH_HX3
*$UNIT_NAME SH_HX3
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 620 592
*$LAYER Main # 
PARAMETERS 3
0.6		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
28,1 		! TeePiece:Outlet temperature ->Source side inlet temperature
28,2 		! TeePiece:Outlet flow rate ->Source side flow rate
Tin_to_HX3_1		! SH_calc:Tin_to_HX3_1 ->Load side inlet temperature
FR_to_HX3_1		! SH_calc:FR_to_HX3_1 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "SH_HX3-2" (Type 91)
* 

UNIT 47 TYPE 91	 SH_HX3-2
*$UNIT_NAME SH_HX3-2
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 607 1258
*$LAYER Main # 
PARAMETERS 3
0.6		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
52,1 		! TeePiece-2:Outlet temperature ->Source side inlet temperature
52,2 		! TeePiece-2:Outlet flow rate ->Source side flow rate
Tin_to_HX3_2		! SH_calc-2:Tin_to_HX3_2 ->Load side inlet temperature
FR_to_HX3_2		! SH_calc-2:FR_to_HX3_2 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* EQUATIONS "SH_calc-2"
* 
EQUATIONS 6
Tin_to_HX3_2 = 55 ! °C
FR_to_HX3_2 = (Q_sh_corr_2)/((max(1,(4.19*(abs(Tset_to_SH_2-Tin_to_HX3_2))))))*3.6 ! delta T is implicit but parameters should be 70/55°C so delta is 15°C
Tset_to_SH_2 = 70 !°C
Q_HX3_2 = [52,2]*4.19*max(0,abs(([52,1] - [47,1])))/3.6
Q_sh_corr_2 = min(Q_HX3_2,[45,2])
SH_HX3_rate_kW = [47,5]/3.6 !kWh/h
*$UNIT_NAME SH_calc-2
*$LAYER Main
*$POSITION 618 1380

*------------------------------------------------------------------------------


* EQUATIONS "Substation-2"
* 
EQUATIONS 4
ThotNet_2 = 90
msource_2 = [50,4]
kWhFromSubstToDHW_2 = [50,5]/3.6
kWhDryCooler_2 = [53,3]/3.6
*$UNIT_NAME Substation-2
*$LAYER Main
*$POSITION 94 1153

*------------------------------------------------------------------------------


* Model "PostHeatCHPout-2" (Type 91)
* 

UNIT 50 TYPE 91	 PostHeatCHPout-2
*$UNIT_NAME PostHeatCHPout-2
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 234 1153
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
ThotNet_2		! Substation-2:ThotNet_2 ->Source side inlet temperature
msource_2		! Substation-2:msource_2 ->Source side flow rate
60,1 		! PreheatFreshWater-2:Source-side outlet temperature ->Load side inlet temperature
60,2 		! PreheatFreshWater-2:Source side flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "Diverter-2" (Type 11)
* 

UNIT 51 TYPE 11	 Diverter-2
*$UNIT_NAME Diverter-2
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 508 1153
*$LAYER Water Loop # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
50,3 		! PostHeatCHPout-2:Load side outlet temperature ->Inlet temperature
50,4 		! PostHeatCHPout-2:Load side flow rate ->Inlet flow rate
59,1 		! Load_Tout-2:Control signal ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 1 
*------------------------------------------------------------------------------

* Model "TeePiece-2" (Type 11)
* 

UNIT 52 TYPE 11	 TeePiece-2
*$UNIT_NAME TeePiece-2
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 676 1100
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
58,20 		! AF3000-2:Temperature at HX Outlet ->Temperature at inlet 1
58,21 		! AF3000-2:HX flow rate ->Flow rate at inlet 1
51,3 		! Diverter-2:Temperature at outlet 2 ->Temperature at inlet 2
51,4 		! Diverter-2:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "DryCooler-2" (Type 511)
* 

UNIT 53 TYPE 511	 DryCooler-2
*$UNIT_NAME DryCooler-2
*$MODEL .\HVAC Library (TESS)\Dry Fluid Cooler\Type511.tmf
*$POSITION 202 1260
*$LAYER Main # 
*$# DRY FLUID COOLER
PARAMETERS 11
1		! 1 Heat exchanger mode
70		! 2 Design inlet fluid temperature
60		! 3 Design outlet fluid temperature
5678.12		! 4 Design fluid flow rate
4.190		! 5 Fluid specific heat
28.0		! 6 Design ambient air temperature
5678.12		! 7 Design air flow rate
5369.04		! 8 Rated fan power
10.0		! 9 Ratio of liquid h to air h
1		! 10 Number of power coefficients
1		! 11 Power coefficient
INPUTS 5
47,1 		! SH_HX3-2:Source-side outlet temperature ->Fluid inlet temperature
47,2 		! SH_HX3-2:Source side flow rate ->Fluid flow rate
67,1 		! 1-2:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Fan control signal
0,0		! [unconnected] Desired outlet temperature
*** INITIAL INPUT VALUES
10.0 0.0 20.0 -1 70 
*------------------------------------------------------------------------------

* EQUATIONS "DHW flow_demand-2"
* 
EQUATIONS 4
Demand_FR_2 = ((0.001*[23,2])/(4.19*(Tload_2-Tcold_2)))*3600
Tcold_2 = 15
Tload_2 = 60
T_hotNet_2 = 90
*$UNIT_NAME DHW flow_demand-2
*$LAYER Main
*$POSITION 234 958

*------------------------------------------------------------------------------


* EQUATIONS "Heat _from_CHP-2"
* 
EQUATIONS 2
TankTempHot_2 = max(GT(PthCHP,0)*(20+[53,1]),[53,1])
TankFR_Hot_2 = [57,2]
*$UNIT_NAME Heat _from_CHP-2
*$LAYER Main
*$POSITION 115 847

*------------------------------------------------------------------------------


* EQUATIONS "DHW Energy rates-2"
* 
EQUATIONS 6
EnergyRatFromCHP_2 = 1000*PumpSignal*4.19*[57,2]*(TankTempHot_2-[58,20])/3600
EnergyRatToDHW_2 = 1000*([58,5]+[60,5])/3600
PumpFR_2 = max(0.7*PumpFRnom_2,(3.6*PthCHP)/(20*4.19))
PumpFRnom_2 = (3.6*PthCHPnom)/(20*4.19)
Pumpsignal_2 = min(1,PumpFR_2/PumpFRnom_2)
CHPTdelta_2 = TankTempHot_2-[58,20]
*$UNIT_NAME DHW Energy rates-2
*$LAYER Main
*$POSITION 386 909

*------------------------------------------------------------------------------


* Model "CHP_Recirc_pump-2" (Type 110)
* 

UNIT 57 TYPE 110	 CHP_Recirc_pump-2
*$UNIT_NAME CHP_Recirc_pump-2
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 389 807
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
2040		! 1 Rated flow rate
4.19		! 2 Fluid specific heat
2684.0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1		! 6 Power coefficient
INPUTS 5
0,0		! [unconnected] Inlet fluid temperature
0,0		! [unconnected] Inlet fluid flow rate
Pumpsignal_2		! DHW Energy rates-2:Pumpsignal_2 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
20.0 0.0 1 0.7 0.9 
*------------------------------------------------------------------------------

* Model "AF3000-2" (Type 534)
* 

UNIT 58 TYPE 534	 AF3000-2
*$UNIT_NAME AF3000-2
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\Coiled Tube HXs\Type534-Coiled.tmf
*$POSITION 503 1060
*$LAYER Main # 
*$# Cylindrical Storage Tank
PARAMETERS 60
-1		! 1 LU for data file
5		! 2 Number of tank nodes
1		! 3 Number of ports
1		! 4 Number of immersed heat exchangers
1		! 5 Number of miscellaneous heat flows
3		! 6 Tank volume
1.5		! 7 Tank height
0		! 8 Tank fluid
4.19		! 9 Fluid specific heat
1000		! 10 Fluid density
2.14		! 11 Fluid thermal conductivity
3.21		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
5.0		! 14 Top loss coefficient
5.0		! 15 Edge loss coefficient for node-1
5.0		! 16 Edge loss coefficient for node-2
5.0		! 17 Edge loss coefficient for node-3
5.0		! 18 Edge loss coefficient for node-4
5.0		! 19 Edge loss coefficient for node-5
5.0		! 20 Bottom loss coefficient
0		! 21 Additional thermal conductivity
1		! 22 Inlet flow mode
1		! 23 Entry node
1		! 24 Exit node
3.0		! 25 Flue loss coefficient for node-1
3.0		! 26 Flue loss coefficient for node-2
3.0		! 27 Flue loss coefficient for node-3
3.0		! 28 Flue loss coefficient for node-4
3.0		! 29 Flue loss coefficient for node-5
1		! 30 Node for miscellaneous heat gain
3		! 31 Type of HX
5		! 32 Number of HX nodes
0		! 33 HX fluid
4.19		! 34 HX fluid specific heat
1000		! 35 HX fluid density
2.14		! 36 HX fluid thermal conductivity
3.21		! 37 HX fluid viscosity
0.6		! 38 Multiplier for natural convection
0.25		! 39 Exponent for natural convection
1.0		! 40 Geometry factor for natural convection
1.0		! 41 Geometry exponent for natural convection
0.035		! 42 Inner tube diameter
0.036505		! 43 Outer tube diameter
2.14		! 44 HX wall thermal conductivity
83		! 45 Length of HX tubes
1		! 46 Number of tubes
0		! 47 HX header volume
0.05		! 48 HX cross sectional area
1		! 49 Coil diameter
0.05		! 50 Coil pitch
1		! 51 Tank node for HX node-1
0.2		! 52 Fraction of HX length-1
1		! 53 Tank node for HX node-2
0.2		! 54 Fraction of HX length-2
1		! 55 Tank node for HX node-3
0.2		! 56 Fraction of HX length-3
1		! 57 Tank node for HX node-4
0.2		! 58 Fraction of HX length-4
1		! 59 Tank node for HX node-5
0.2		! 60 Fraction of HX length-5
INPUTS 19
60,3 		! PreheatFreshWater-2:Load side outlet temperature ->Inlet temperature for port
60,4 		! PreheatFreshWater-2:Load side flow rate ->Inlet flow rate for port
51,1 		! Diverter-2:Temperature at outlet 1 ->Inlet temperature for HX
51,2 		! Diverter-2:Flow rate at outlet 1 ->Inlet flow rate for HX
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Edge loss temperature for node-4
0,0		! [unconnected] Edge loss temperature for node-5
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
0,0		! [unconnected] Auxiliary heat input for node-4
0,0		! [unconnected] Auxiliary heat input for node-5
0,0		! [unconnected] Miscellaneous heat input
*** INITIAL INPUT VALUES
20.0 0.0 20.0 0.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 0.0
0.0 0 
DERIVATIVES 5
20.0		! 1 Initial Tank Temperature-1
20.0		! 2 Initial Tank Temperature-2
20.0		! 3 Initial Tank Temperature-3
20.0		! 4 Initial Tank Temperature-4
20.0		! 5 Initial Tank Temperature-5
*------------------------------------------------------------------------------

* Model "Load_Tout-2" (Type 22)
* 

UNIT 59 TYPE 22	 Load_Tout-2
*$UNIT_NAME Load_Tout-2
*$MODEL .\Controllers\Iterative Feedback Controller\Type22.tmf
*$POSITION 599 833
*$LAYER Main # 
PARAMETERS 2
0		! 1 mode
0		! 2 Maximum number of oscillations
INPUTS 7
Tload_2		! DHW flow_demand-2:Tload_2 ->Setpoint
58,1 		! AF3000-2:Temperature at outlet ->Controlled variable
0,0		! [unconnected] On / Off signal
0,0		! [unconnected] Minimum control signal
0,0		! [unconnected] Maximum control signal
0,0		! [unconnected] Threshold for non-zero output
0,0		! [unconnected] Tolerance on tracking error
*** INITIAL INPUT VALUES
58 0 1 0 1 0 0 
*------------------------------------------------------------------------------

* Model "PreheatFreshWater-2" (Type 91)
* 

UNIT 60 TYPE 91	 PreheatFreshWater-2
*$UNIT_NAME PreheatFreshWater-2
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 234 1060
*$LAYER Main # 
PARAMETERS 3
0		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
TankTempHot_2		! Heat _from_CHP-2:TankTempHot_2 ->Source side inlet temperature
TankFR_Hot_2		! Heat _from_CHP-2:TankFR_Hot_2 ->Source side flow rate
Tcold_2		! DHW flow_demand-2:Tcold_2 ->Load side inlet temperature
Demand_FR_2		! DHW flow_demand-2:Demand_FR_2 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "CHP controller-2" (Type 102)
* 

UNIT 61 TYPE 102	 CHP controller-2
*$UNIT_NAME CHP controller-2
*$MODEL .\Electrical\Diesel Engine (DEGS)\DEGS Dispatch Controller\Type102a.tmf
*$POSITION 1834 332
*$LAYER Main # 
PARAMETERS 5
1		! 1 Minimum number of DEGS in operation
1		! 2 Maximum number of DEGS in operation
250		! 3 DEGS rated power
0.4		! 4 Minimum turndown
1		! 5 Maximum power
INPUTS 1
PDEGSwlot_2		! Control-2:PDEGSwlot_2 ->Load power
*** INITIAL INPUT VALUES
500000 
*------------------------------------------------------------------------------

* EQUATIONS "Spaceheating-2"
* 
EQUATIONS 1
EnergyRateToDSH_2 = max(0,PthCHP-EnergyRatToDHW_2)
*$UNIT_NAME Spaceheating-2
*$LAYER Main
*$POSITION 1659 327

*------------------------------------------------------------------------------


* Model "CHP engine-2" (Type 120)
* 

UNIT 63 TYPE 120	 CHP engine-2
*$UNIT_NAME CHP engine-2
*$MODEL .\Electrical\Diesel Engine (DEGS)\Generic Model\Type120a.tmf
*$POSITION 1834 434
*$LAYER Main # 
*$# Generic Model DEGS
PARAMETERS 5
1		! 1 DEGS mode
5		! 2 DEGS fuel type
250		! 3 Maximum DEGS power
10		! 4 Minimum DEGS power
250		! 5 Rated power
INPUTS 3
wlacznikfinal_2		! Control-2:wlacznikfinal_2 ->DEGS on/off switch
61,1 		! CHP controller-2:Single DEG power ->DEGS power set point
61,2 		! CHP controller-2:Number of DEGS in operation ->Number of units on
*** INITIAL INPUT VALUES
1 300000 1 
*------------------------------------------------------------------------------

* EQUATIONS "Heat Production by CHP-2"
* 
EQUATIONS 4
PthCHP = GT([63,1],0)*(A*[63,1]+B*1000) 
A = 1.6668
B = 5.86345
PthCHPnom = GT(CHP_Pel_2,0)*(A*CHP_Pel_2+B*1000)    
*$UNIT_NAME Heat Production by CHP-2
*$LAYER Main
*$POSITION 1659 433

*------------------------------------------------------------------------------


* EQUATIONS "Control-2"
* 
EQUATIONS 10
Pload1_2 = max(([18,3]-[66,4]),0)
PDEGSmin_2 = 1*0.4*CHP_Pel_2
PDEGSmax_2 = 1*1*CHP_Pel_2
PDEGS_2 = max(Pload1_2,PDEGSmin_2)
PDEGSwlot_2 = min(PDEGSmax_2,PDEGS_2)
wlacznik_2 = GT(Pload1_2,0)*1+(1-GT(Pload1_2,0))*0
wlacznik1_2 = GT(Pload1_2,PDEGSmin_2)*1 + (1-GT(Pload1_2,PDEGSmin_2))*1
wlacznikfinal_2 = min(wlacznik_2,wlacznik_21)
CHP_Pel_2 = 25000
EnElBought_2 = max(0,[18,3]-[66,4]-PDEGSwlot_2) ! electric energy bought from net
*$UNIT_NAME Control-2
*$LAYER Main
*$POSITION 579 389

*------------------------------------------------------------------------------


* Model "1_PV-Inverter-2" (Type 194)
* 

UNIT 66 TYPE 194	 1_PV-Inverter-2
*$UNIT_NAME 1_PV-Inverter-2
*$MODEL .\Electrical\Photovoltaic Panels\With Inverter\Type194b.tmf
*$POSITION 701 389
*$LAYER Main # 
PARAMETERS 29
2		! 1 Mode
8.63		! 2 Module short-circuit current at reference conditions
37.68		! 3 Module open-circuit voltage at reference conditions
298		! 4 Reference temperature
1000		! 5 Reference insolation
30.93		! 6 Module voltage at max power point and reference conditions
8.08		! 7 Module current at max power point and reference conditions
0.07		! 8 Temperature coeficient of Isc at (ref. cond)
-0.34		! 9 Temperature coeficient of Voc (ref. cond.)
60		! 10 Number of cells wired in series
120		! 11 Number of modules in series
1		! 12 Number of modules in parallel
319		! 13 Module temperature at NOCT
293		! 14 Ambient temperature at NOCT
800		! 15 Insolation at NOCT
1.6		! 16 Module area
0.99		! 17 tau-alpha product for normal incidence
1.12		! 18 Semiconductor bandgap
1.9		! 19 Value of parameter "a" at reference conditions
5.4		! 20 Value of parameter I_L at reference conditions
0		! 21 Value of parametre I_0 at reference conditions
0.5		! 22 Module series resistance
45.81		! 23 Shunt resistance at reference conditions
0.008		! 24 Extinction coefficient-thickness product of cover
40800		! 25 Maximum inverter power
10000		! 26 Maximium inverter voltage
0		! 27 Minimum inverter voltage
0		! 28 Night tare
131		! 29 Logical unit number for inverter data
INPUTS 10
67,24 		! 1-2:Total tilted surface radiation for surface ->Total incident radiation on tilted surface
67,1 		! 1-2:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Load voltage
67,30 		! 1-2:Slope of surface ->Array slope
67,25 		! 1-2:Beam radiation for surface ->Beam radiation on tilted surface
67,26 		! 1-2:Sky diffuse radiation for surface ->Sky diffuse radiation on tilted surface
67,27 		! 1-2:Ground reflected diffuse radiation for surface ->Ground diffuse radiation on tilted surface
67,29 		! 1-2:Angle of incidence for surface ->Incidence angle on tilted surface
67,16 		! 1-2:Solar zenith angle ->Solar zenith angle
67,8 		! 1-2:Wind velocity ->Wind speed
*** INITIAL INPUT VALUES
0 0 0 0 0 0 0 0 0 0 
*** External files
ASSIGN "C:\Dysk Google\CHP model\Type194-inverter.dat" 131
*|? What file contains the inverter parameters? |1000
*------------------------------------------------------------------------------

* Model "1-2" (Type 15)
* 

UNIT 67 TYPE 15	 1-2
*$UNIT_NAME 1-2
*$MODEL .\Weather Data Reading and Processing\Standard Format\TMY2\Type15-2.tmf
*$POSITION 818 387
*$LAYER Main # 
PARAMETERS 9
2		! 1 File Type
132		! 2 Logical unit
5		! 3 Tilted Surface Radiation Mode
0.2		! 4 Ground reflectance - no snow
0.7		! 5 Ground reflectance - snow cover
1		! 6 Number of surfaces
1		! 7 Tracking mode
45		! 8 Slope of surface
0		! 9 Azimuth of surface
*** External files
ASSIGN "C:\TRNSYS17\Weather\Meteonorm\Europe\PL-Warszawa-123750.tm2" 132
*|? Which file contains the TMY-2 weather data? |1000
*------------------------------------------------------------------------------

* Model "SH_HX3-3" (Type 91)
* 

UNIT 68 TYPE 91	 SH_HX3-3
*$UNIT_NAME SH_HX3-3
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 607 1738
*$LAYER Main # 
PARAMETERS 3
0.6		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
73,1 		! TeePiece-3:Outlet temperature ->Source side inlet temperature
73,2 		! TeePiece-3:Outlet flow rate ->Source side flow rate
Tin_to_HX3_3		! SH_calc-3:Tin_to_HX3_3 ->Load side inlet temperature
FR_to_HX3_3		! SH_calc-3:FR_to_HX3_3 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* EQUATIONS "SH_calc-3"
* 
EQUATIONS 6
Tin_to_HX3_3 = 55 ! °C
FR_to_HX3_3 = (Q_sh_corr_3)/((max(1,(4.19*(abs(Tset_to_SH_3-Tin_to_HX3_3))))))*3.6 ! delta T is implicit but parameters should be 70/55°C so delta is 15°C
Tset_to_SH_3 = 70 !°C
Q_HX3_3 = [73,2]*4.19*max(0,abs(([73,1] - [68,1])))/3.6
Q_sh_corr_3 = min(Q_HX3_3,[45,3])
SH_HX3_rate_kW = [68,5]/3.6 !kWh/h
*$UNIT_NAME SH_calc-3
*$LAYER Main
*$POSITION 613 1860

*------------------------------------------------------------------------------


* EQUATIONS "Substation-3"
* 
EQUATIONS 4
ThotNet_3 = 90
msource_3 = [71,4]
kWhFromSubstToDHW_3 = [71,5]/3.6
kWhDryCooler_3 = [74,3]/3.6
*$UNIT_NAME Substation-3
*$LAYER Main
*$POSITION 94 1633

*------------------------------------------------------------------------------


* Model "PostHeatCHPout-3" (Type 91)
* 

UNIT 71 TYPE 91	 PostHeatCHPout-3
*$UNIT_NAME PostHeatCHPout-3
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 234 1633
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
ThotNet_3		! Substation-3:ThotNet_3 ->Source side inlet temperature
msource_3		! Substation-3:msource_3 ->Source side flow rate
81,1 		! PreheatFreshWater-3:Source-side outlet temperature ->Load side inlet temperature
81,2 		! PreheatFreshWater-3:Source side flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "Diverter-3" (Type 11)
* 

UNIT 72 TYPE 11	 Diverter-3
*$UNIT_NAME Diverter-3
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 508 1633
*$LAYER Water Loop # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
71,3 		! PostHeatCHPout-3:Load side outlet temperature ->Inlet temperature
71,4 		! PostHeatCHPout-3:Load side flow rate ->Inlet flow rate
80,1 		! Load_Tout-3:Control signal ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 1 
*------------------------------------------------------------------------------

* Model "TeePiece-3" (Type 11)
* 

UNIT 73 TYPE 11	 TeePiece-3
*$UNIT_NAME TeePiece-3
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 676 1580
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
79,20 		! AF3000-3:Temperature at HX Outlet ->Temperature at inlet 1
79,21 		! AF3000-3:HX flow rate ->Flow rate at inlet 1
72,3 		! Diverter-3:Temperature at outlet 2 ->Temperature at inlet 2
72,4 		! Diverter-3:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "DryCooler-3" (Type 511)
* 

UNIT 74 TYPE 511	 DryCooler-3
*$UNIT_NAME DryCooler-3
*$MODEL .\HVAC Library (TESS)\Dry Fluid Cooler\Type511.tmf
*$POSITION 202 1740
*$LAYER Main # 
*$# DRY FLUID COOLER
PARAMETERS 11
1		! 1 Heat exchanger mode
70		! 2 Design inlet fluid temperature
60		! 3 Design outlet fluid temperature
5678.12		! 4 Design fluid flow rate
4.190		! 5 Fluid specific heat
28.0		! 6 Design ambient air temperature
5678.12		! 7 Design air flow rate
5369.04		! 8 Rated fan power
10.0		! 9 Ratio of liquid h to air h
1		! 10 Number of power coefficients
1		! 11 Power coefficient
INPUTS 5
68,1 		! SH_HX3-3:Source-side outlet temperature ->Fluid inlet temperature
68,2 		! SH_HX3-3:Source side flow rate ->Fluid flow rate
88,1 		! 1-3:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Fan control signal
0,0		! [unconnected] Desired outlet temperature
*** INITIAL INPUT VALUES
10.0 0.0 20.0 -1 70 
*------------------------------------------------------------------------------

* EQUATIONS "DHW flow_demand-3"
* 
EQUATIONS 4
Demand_FR_3 = ((0.001*[23,3])/(4.19*(Tload_3-Tcold_3)))*3600
Tcold_3 = 15
Tload_3 = 60
T_hotNet_3 = 90
*$UNIT_NAME DHW flow_demand-3
*$LAYER Main
*$POSITION 234 1438

*------------------------------------------------------------------------------


* EQUATIONS "Heat _from_CHP-3"
* 
EQUATIONS 2
TankTempHot_3 = max(GT(PthCHP,0)*(20+[74,1]),[74,1])
TankFR_Hot_3 = [78,2]
*$UNIT_NAME Heat _from_CHP-3
*$LAYER Main
*$POSITION 115 1327

*------------------------------------------------------------------------------


* EQUATIONS "DHW Energy rates-3"
* 
EQUATIONS 6
EnergyRatFromCHP_3 = 1000*PumpSignal*4.19*[78,2]*(TankTempHot_3-[79,20])/3600
EnergyRatToDHW_3 = 1000*([79,5]+[81,5])/3600
PumpFR_3 = max(0.7*PumpFRnom_3,(3.6*PthCHP)/(20*4.19))
PumpFRnom_3 = (3.6*PthCHPnom)/(20*4.19)
Pumpsignal_3 = min(1,PumpFR_3/PumpFRnom_3)
CHPTdelta_3 = TankTempHot_3-[79,20]
*$UNIT_NAME DHW Energy rates-3
*$LAYER Main
*$POSITION 386 1389

*------------------------------------------------------------------------------


* Model "CHP_Recirc_pump-3" (Type 110)
* 

UNIT 78 TYPE 110	 CHP_Recirc_pump-3
*$UNIT_NAME CHP_Recirc_pump-3
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 389 1287
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
2040		! 1 Rated flow rate
4.19		! 2 Fluid specific heat
2684.0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1		! 6 Power coefficient
INPUTS 5
0,0		! [unconnected] Inlet fluid temperature
0,0		! [unconnected] Inlet fluid flow rate
Pumpsignal_3		! DHW Energy rates-3:Pumpsignal_3 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
20.0 0.0 1 0.7 0.9 
*------------------------------------------------------------------------------

* Model "AF3000-3" (Type 534)
* 

UNIT 79 TYPE 534	 AF3000-3
*$UNIT_NAME AF3000-3
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\Coiled Tube HXs\Type534-Coiled.tmf
*$POSITION 503 1540
*$LAYER Main # 
*$# Cylindrical Storage Tank
PARAMETERS 60
-1		! 1 LU for data file
5		! 2 Number of tank nodes
1		! 3 Number of ports
1		! 4 Number of immersed heat exchangers
1		! 5 Number of miscellaneous heat flows
3		! 6 Tank volume
1.5		! 7 Tank height
0		! 8 Tank fluid
4.19		! 9 Fluid specific heat
1000		! 10 Fluid density
2.14		! 11 Fluid thermal conductivity
3.21		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
5.0		! 14 Top loss coefficient
5.0		! 15 Edge loss coefficient for node-1
5.0		! 16 Edge loss coefficient for node-2
5.0		! 17 Edge loss coefficient for node-3
5.0		! 18 Edge loss coefficient for node-4
5.0		! 19 Edge loss coefficient for node-5
5.0		! 20 Bottom loss coefficient
0		! 21 Additional thermal conductivity
1		! 22 Inlet flow mode
1		! 23 Entry node
1		! 24 Exit node
3.0		! 25 Flue loss coefficient for node-1
3.0		! 26 Flue loss coefficient for node-2
3.0		! 27 Flue loss coefficient for node-3
3.0		! 28 Flue loss coefficient for node-4
3.0		! 29 Flue loss coefficient for node-5
1		! 30 Node for miscellaneous heat gain
3		! 31 Type of HX
5		! 32 Number of HX nodes
0		! 33 HX fluid
4.19		! 34 HX fluid specific heat
1000		! 35 HX fluid density
2.14		! 36 HX fluid thermal conductivity
3.21		! 37 HX fluid viscosity
0.6		! 38 Multiplier for natural convection
0.25		! 39 Exponent for natural convection
1.0		! 40 Geometry factor for natural convection
1.0		! 41 Geometry exponent for natural convection
0.035		! 42 Inner tube diameter
0.036505		! 43 Outer tube diameter
2.14		! 44 HX wall thermal conductivity
83		! 45 Length of HX tubes
1		! 46 Number of tubes
0		! 47 HX header volume
0.05		! 48 HX cross sectional area
1		! 49 Coil diameter
0.05		! 50 Coil pitch
1		! 51 Tank node for HX node-1
0.2		! 52 Fraction of HX length-1
1		! 53 Tank node for HX node-2
0.2		! 54 Fraction of HX length-2
1		! 55 Tank node for HX node-3
0.2		! 56 Fraction of HX length-3
1		! 57 Tank node for HX node-4
0.2		! 58 Fraction of HX length-4
1		! 59 Tank node for HX node-5
0.2		! 60 Fraction of HX length-5
INPUTS 19
81,3 		! PreheatFreshWater-3:Load side outlet temperature ->Inlet temperature for port
81,4 		! PreheatFreshWater-3:Load side flow rate ->Inlet flow rate for port
72,1 		! Diverter-3:Temperature at outlet 1 ->Inlet temperature for HX
72,2 		! Diverter-3:Flow rate at outlet 1 ->Inlet flow rate for HX
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Edge loss temperature for node-4
0,0		! [unconnected] Edge loss temperature for node-5
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
0,0		! [unconnected] Auxiliary heat input for node-4
0,0		! [unconnected] Auxiliary heat input for node-5
0,0		! [unconnected] Miscellaneous heat input
*** INITIAL INPUT VALUES
20.0 0.0 20.0 0.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 0.0
0.0 0 
DERIVATIVES 5
20.0		! 1 Initial Tank Temperature-1
20.0		! 2 Initial Tank Temperature-2
20.0		! 3 Initial Tank Temperature-3
20.0		! 4 Initial Tank Temperature-4
20.0		! 5 Initial Tank Temperature-5
*------------------------------------------------------------------------------

* Model "Load_Tout-3" (Type 22)
* 

UNIT 80 TYPE 22	 Load_Tout-3
*$UNIT_NAME Load_Tout-3
*$MODEL .\Controllers\Iterative Feedback Controller\Type22.tmf
*$POSITION 599 1313
*$LAYER Main # 
PARAMETERS 2
0		! 1 mode
0		! 2 Maximum number of oscillations
INPUTS 7
Tload_3		! DHW flow_demand-3:Tload_3 ->Setpoint
79,1 		! AF3000-3:Temperature at outlet ->Controlled variable
0,0		! [unconnected] On / Off signal
0,0		! [unconnected] Minimum control signal
0,0		! [unconnected] Maximum control signal
0,0		! [unconnected] Threshold for non-zero output
0,0		! [unconnected] Tolerance on tracking error
*** INITIAL INPUT VALUES
58 0 1 0 1 0 0 
*------------------------------------------------------------------------------

* Model "PreheatFreshWater-3" (Type 91)
* 

UNIT 81 TYPE 91	 PreheatFreshWater-3
*$UNIT_NAME PreheatFreshWater-3
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 234 1540
*$LAYER Main # 
PARAMETERS 3
0		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
TankTempHot_3		! Heat _from_CHP-3:TankTempHot_3 ->Source side inlet temperature
TankFR_Hot_3		! Heat _from_CHP-3:TankFR_Hot_3 ->Source side flow rate
Tcold_3		! DHW flow_demand-3:Tcold_3 ->Load side inlet temperature
Demand_FR_3		! DHW flow_demand-3:Demand_FR_3 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "CHP controller-3" (Type 102)
* 

UNIT 82 TYPE 102	 CHP controller-3
*$UNIT_NAME CHP controller-3
*$MODEL .\Electrical\Diesel Engine (DEGS)\DEGS Dispatch Controller\Type102a.tmf
*$POSITION 1847 559
*$LAYER Main # 
PARAMETERS 5
1		! 1 Minimum number of DEGS in operation
1		! 2 Maximum number of DEGS in operation
250		! 3 DEGS rated power
0.4		! 4 Minimum turndown
1		! 5 Maximum power
INPUTS 1
PDEGSwlot_3		! Control-3:PDEGSwlot_3 ->Load power
*** INITIAL INPUT VALUES
500000 
*------------------------------------------------------------------------------

* EQUATIONS "Spaceheating-3"
* 
EQUATIONS 1
EnergyRateToDSH_3 = max(0,PthCHP-EnergyRatToDHW_3)
*$UNIT_NAME Spaceheating-3
*$LAYER Main
*$POSITION 1672 554

*------------------------------------------------------------------------------


* Model "CHP engine-3" (Type 120)
* 

UNIT 84 TYPE 120	 CHP engine-3
*$UNIT_NAME CHP engine-3
*$MODEL .\Electrical\Diesel Engine (DEGS)\Generic Model\Type120a.tmf
*$POSITION 1847 661
*$LAYER Main # 
*$# Generic Model DEGS
PARAMETERS 5
1		! 1 DEGS mode
5		! 2 DEGS fuel type
250		! 3 Maximum DEGS power
10		! 4 Minimum DEGS power
250		! 5 Rated power
INPUTS 3
wlacznikfinal_3		! Control-3:wlacznikfinal_3 ->DEGS on/off switch
82,1 		! CHP controller-3:Single DEG power ->DEGS power set point
82,2 		! CHP controller-3:Number of DEGS in operation ->Number of units on
*** INITIAL INPUT VALUES
1 300000 1 
*------------------------------------------------------------------------------

* EQUATIONS "Heat Production by CHP-3"
* 
EQUATIONS 4
PthCHP = GT([84,1],0)*(A*[84,1]+B*1000) 
A = 1.6668
B = 5.86345
PthCHPnom = GT(CHP_Pel_3,0)*(A*CHP_Pel_3+B*1000)    
*$UNIT_NAME Heat Production by CHP-3
*$LAYER Main
*$POSITION 1672 660

*------------------------------------------------------------------------------


* EQUATIONS "Control-3"
* 
EQUATIONS 10
Pload1_3 = max(([18,4]-[87,4]),0)
PDEGSmin_3 = 1*0.4*CHP_Pel_3
PDEGSmax_3 = 1*1*CHP_Pel_3
PDEGS_3 = max(Pload1_3,PDEGSmin_3)
PDEGSwlot_3 = min(PDEGSmax_3,PDEGS_3)
wlacznik_3 = GT(Pload1_3,0)*1+(1-GT(Pload1_3,0))*0
wlacznik1_3 = GT(Pload1_3,PDEGSmin_3)*1 + (1-GT(Pload1_3,PDEGSmin_3))*1
wlacznikfinal_3 = min(wlacznik_3,wlacznik_31)
CHP_Pel_3 = 20000
EnElBought_3 = max(0,Pel_demand-PV_production-PDEGSwlot_3) ! electric energy bought from net
*$UNIT_NAME Control-3
*$LAYER Main
*$POSITION 578 470

*------------------------------------------------------------------------------


* Model "1_PV-Inverter-3" (Type 194)
* 

UNIT 87 TYPE 194	 1_PV-Inverter-3
*$UNIT_NAME 1_PV-Inverter-3
*$MODEL .\Electrical\Photovoltaic Panels\With Inverter\Type194b.tmf
*$POSITION 700 470
*$LAYER Main # 
PARAMETERS 29
2		! 1 Mode
8.63		! 2 Module short-circuit current at reference conditions
37.68		! 3 Module open-circuit voltage at reference conditions
298		! 4 Reference temperature
1000		! 5 Reference insolation
30.93		! 6 Module voltage at max power point and reference conditions
8.08		! 7 Module current at max power point and reference conditions
0.07		! 8 Temperature coeficient of Isc at (ref. cond)
-0.34		! 9 Temperature coeficient of Voc (ref. cond.)
60		! 10 Number of cells wired in series
77		! 11 Number of modules in series
1		! 12 Number of modules in parallel
319		! 13 Module temperature at NOCT
293		! 14 Ambient temperature at NOCT
800		! 15 Insolation at NOCT
1.6		! 16 Module area
0.99		! 17 tau-alpha product for normal incidence
1.12		! 18 Semiconductor bandgap
1.9		! 19 Value of parameter "a" at reference conditions
5.4		! 20 Value of parameter I_L at reference conditions
0		! 21 Value of parametre I_0 at reference conditions
0.5		! 22 Module series resistance
45.81		! 23 Shunt resistance at reference conditions
0.008		! 24 Extinction coefficient-thickness product of cover
40800		! 25 Maximum inverter power
10000		! 26 Maximium inverter voltage
0		! 27 Minimum inverter voltage
0		! 28 Night tare
133		! 29 Logical unit number for inverter data
INPUTS 10
88,24 		! 1-3:Total tilted surface radiation for surface ->Total incident radiation on tilted surface
88,1 		! 1-3:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Load voltage
88,30 		! 1-3:Slope of surface ->Array slope
88,25 		! 1-3:Beam radiation for surface ->Beam radiation on tilted surface
88,26 		! 1-3:Sky diffuse radiation for surface ->Sky diffuse radiation on tilted surface
88,27 		! 1-3:Ground reflected diffuse radiation for surface ->Ground diffuse radiation on tilted surface
88,29 		! 1-3:Angle of incidence for surface ->Incidence angle on tilted surface
88,16 		! 1-3:Solar zenith angle ->Solar zenith angle
88,8 		! 1-3:Wind velocity ->Wind speed
*** INITIAL INPUT VALUES
0 0 0 0 0 0 0 0 0 0 
*** External files
ASSIGN "C:\Dysk Google\CHP model\Type194-inverter.dat" 133
*|? What file contains the inverter parameters? |1000
*------------------------------------------------------------------------------

* Model "1-3" (Type 15)
* 

UNIT 88 TYPE 15	 1-3
*$UNIT_NAME 1-3
*$MODEL .\Weather Data Reading and Processing\Standard Format\TMY2\Type15-2.tmf
*$POSITION 817 468
*$LAYER Main # 
PARAMETERS 9
2		! 1 File Type
134		! 2 Logical unit
5		! 3 Tilted Surface Radiation Mode
0.2		! 4 Ground reflectance - no snow
0.7		! 5 Ground reflectance - snow cover
1		! 6 Number of surfaces
1		! 7 Tracking mode
45		! 8 Slope of surface
0		! 9 Azimuth of surface
*** External files
ASSIGN "C:\TRNSYS17\Weather\Meteonorm\Europe\PL-Warszawa-123750.tm2" 134
*|? Which file contains the TMY-2 weather data? |1000
*------------------------------------------------------------------------------

* Model "SH_HX3-4" (Type 91)
* 

UNIT 89 TYPE 91	 SH_HX3-4
*$UNIT_NAME SH_HX3-4
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 629 2165
*$LAYER Main # 
PARAMETERS 3
0.6		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
94,1 		! TeePiece-4:Outlet temperature ->Source side inlet temperature
94,2 		! TeePiece-4:Outlet flow rate ->Source side flow rate
Tin_to_HX3_4		! SH_calc-4:Tin_to_HX3_4 ->Load side inlet temperature
FR_to_HX3_4		! SH_calc-4:FR_to_HX3_4 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* EQUATIONS "SH_calc-4"
* 
EQUATIONS 6
Tin_to_HX3_4 = 55 ! °C
FR_to_HX3_4 = (Q_sh_corr_4)/((max(1,(4.19*(abs(Tset_to_SH_4-Tin_to_HX3_4))))))*3.6 ! delta T is implicit but parameters should be 70/55°C so delta is 15°C
Tset_to_SH_4 = 70 !°C
Q_HX3_4 = [94,2]*4.19*max(0,abs(([94,1] - [89,1])))/3.6
Q_sh_corr_4 = min(Q_HX3_4,[45,4])
SH_HX3_rate_kW = [89,5]/3.6 !kWh/h
*$UNIT_NAME SH_calc-4
*$LAYER Main
*$POSITION 635 2287

*------------------------------------------------------------------------------


* EQUATIONS "Substation-4"
* 
EQUATIONS 4
ThotNet_4 = 90
msource_4 = [92,4]
kWhFromSubstToDHW_4 = [92,5]/3.6
kWhDryCooler_4 = [95,3]/3.6
*$UNIT_NAME Substation-4
*$LAYER Main
*$POSITION 116 2060

*------------------------------------------------------------------------------


* Model "PostHeatCHPout-4" (Type 91)
* 

UNIT 92 TYPE 91	 PostHeatCHPout-4
*$UNIT_NAME PostHeatCHPout-4
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 256 2060
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
ThotNet_4		! Substation-4:ThotNet_4 ->Source side inlet temperature
msource_4		! Substation-4:msource_4 ->Source side flow rate
102,1 		! PreheatFreshWater-4:Source-side outlet temperature ->Load side inlet temperature
102,2 		! PreheatFreshWater-4:Source side flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "Diverter-4" (Type 11)
* 

UNIT 93 TYPE 11	 Diverter-4
*$UNIT_NAME Diverter-4
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 530 2060
*$LAYER Water Loop # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
92,3 		! PostHeatCHPout-4:Load side outlet temperature ->Inlet temperature
92,4 		! PostHeatCHPout-4:Load side flow rate ->Inlet flow rate
101,1 		! Load_Tout-4:Control signal ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 1 
*------------------------------------------------------------------------------

* Model "TeePiece-4" (Type 11)
* 

UNIT 94 TYPE 11	 TeePiece-4
*$UNIT_NAME TeePiece-4
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 698 2007
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
100,20 		! AF3000-4:Temperature at HX Outlet ->Temperature at inlet 1
100,21 		! AF3000-4:HX flow rate ->Flow rate at inlet 1
93,3 		! Diverter-4:Temperature at outlet 2 ->Temperature at inlet 2
93,4 		! Diverter-4:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "DryCooler-4" (Type 511)
* 

UNIT 95 TYPE 511	 DryCooler-4
*$UNIT_NAME DryCooler-4
*$MODEL .\HVAC Library (TESS)\Dry Fluid Cooler\Type511.tmf
*$POSITION 224 2167
*$LAYER Main # 
*$# DRY FLUID COOLER
PARAMETERS 11
1		! 1 Heat exchanger mode
70		! 2 Design inlet fluid temperature
60		! 3 Design outlet fluid temperature
5678.12		! 4 Design fluid flow rate
4.190		! 5 Fluid specific heat
28.0		! 6 Design ambient air temperature
5678.12		! 7 Design air flow rate
5369.04		! 8 Rated fan power
10.0		! 9 Ratio of liquid h to air h
1		! 10 Number of power coefficients
1		! 11 Power coefficient
INPUTS 5
89,1 		! SH_HX3-4:Source-side outlet temperature ->Fluid inlet temperature
89,2 		! SH_HX3-4:Source side flow rate ->Fluid flow rate
109,1 		! 1-4:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Fan control signal
0,0		! [unconnected] Desired outlet temperature
*** INITIAL INPUT VALUES
10.0 0.0 20.0 -1 70 
*------------------------------------------------------------------------------

* EQUATIONS "DHW flow_demand-4"
* 
EQUATIONS 4
Demand_FR_4 = ((0.001*[23,4])/(4.19*(Tload_4-Tcold_4)))*3600
Tcold_4 = 15
Tload_4 = 60
T_hotNet_4 = 90
*$UNIT_NAME DHW flow_demand-4
*$LAYER Main
*$POSITION 256 1865

*------------------------------------------------------------------------------


* EQUATIONS "Heat _from_CHP-4"
* 
EQUATIONS 2
TankTempHot_4 = max(GT(PthCHP,0)*(20+[95,1]),[95,1])
TankFR_Hot_4 = [99,2]
*$UNIT_NAME Heat _from_CHP-4
*$LAYER Main
*$POSITION 137 1754

*------------------------------------------------------------------------------


* EQUATIONS "DHW Energy rates-4"
* 
EQUATIONS 6
EnergyRatFromCHP_4 = 1000*PumpSignal*4.19*[99,2]*(TankTempHot_4-[100,20])/3600
EnergyRatToDHW_4 = 1000*([100,5]+[102,5])/3600
PumpFR_4 = max(0.7*PumpFRnom_4,(3.6*PthCHP)/(20*4.19))
PumpFRnom_4 = (3.6*PthCHPnom)/(20*4.19)
Pumpsignal_4 = min(1,PumpFR_4/PumpFRnom_4)
CHPTdelta_4 = TankTempHot_4-[100,20]
*$UNIT_NAME DHW Energy rates-4
*$LAYER Main
*$POSITION 408 1816

*------------------------------------------------------------------------------


* Model "CHP_Recirc_pump-4" (Type 110)
* 

UNIT 99 TYPE 110	 CHP_Recirc_pump-4
*$UNIT_NAME CHP_Recirc_pump-4
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 411 1714
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
2040		! 1 Rated flow rate
4.19		! 2 Fluid specific heat
2684.0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1		! 6 Power coefficient
INPUTS 5
0,0		! [unconnected] Inlet fluid temperature
0,0		! [unconnected] Inlet fluid flow rate
Pumpsignal_4		! DHW Energy rates-4:Pumpsignal_4 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
20.0 0.0 1 0.7 0.9 
*------------------------------------------------------------------------------

* Model "AF3000-4" (Type 534)
* 

UNIT 100 TYPE 534	 AF3000-4
*$UNIT_NAME AF3000-4
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\Coiled Tube HXs\Type534-Coiled.tmf
*$POSITION 525 1967
*$LAYER Main # 
*$# Cylindrical Storage Tank
PARAMETERS 60
-1		! 1 LU for data file
5		! 2 Number of tank nodes
1		! 3 Number of ports
1		! 4 Number of immersed heat exchangers
1		! 5 Number of miscellaneous heat flows
3		! 6 Tank volume
1.5		! 7 Tank height
0		! 8 Tank fluid
4.19		! 9 Fluid specific heat
1000		! 10 Fluid density
2.14		! 11 Fluid thermal conductivity
3.21		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
5.0		! 14 Top loss coefficient
5.0		! 15 Edge loss coefficient for node-1
5.0		! 16 Edge loss coefficient for node-2
5.0		! 17 Edge loss coefficient for node-3
5.0		! 18 Edge loss coefficient for node-4
5.0		! 19 Edge loss coefficient for node-5
5.0		! 20 Bottom loss coefficient
0		! 21 Additional thermal conductivity
1		! 22 Inlet flow mode
1		! 23 Entry node
1		! 24 Exit node
3.0		! 25 Flue loss coefficient for node-1
3.0		! 26 Flue loss coefficient for node-2
3.0		! 27 Flue loss coefficient for node-3
3.0		! 28 Flue loss coefficient for node-4
3.0		! 29 Flue loss coefficient for node-5
1		! 30 Node for miscellaneous heat gain
3		! 31 Type of HX
5		! 32 Number of HX nodes
0		! 33 HX fluid
4.19		! 34 HX fluid specific heat
1000		! 35 HX fluid density
2.14		! 36 HX fluid thermal conductivity
3.21		! 37 HX fluid viscosity
0.6		! 38 Multiplier for natural convection
0.25		! 39 Exponent for natural convection
1.0		! 40 Geometry factor for natural convection
1.0		! 41 Geometry exponent for natural convection
0.035		! 42 Inner tube diameter
0.036505		! 43 Outer tube diameter
2.14		! 44 HX wall thermal conductivity
83		! 45 Length of HX tubes
1		! 46 Number of tubes
0		! 47 HX header volume
0.05		! 48 HX cross sectional area
1		! 49 Coil diameter
0.05		! 50 Coil pitch
1		! 51 Tank node for HX node-1
0.2		! 52 Fraction of HX length-1
1		! 53 Tank node for HX node-2
0.2		! 54 Fraction of HX length-2
1		! 55 Tank node for HX node-3
0.2		! 56 Fraction of HX length-3
1		! 57 Tank node for HX node-4
0.2		! 58 Fraction of HX length-4
1		! 59 Tank node for HX node-5
0.2		! 60 Fraction of HX length-5
INPUTS 19
102,3 		! PreheatFreshWater-4:Load side outlet temperature ->Inlet temperature for port
102,4 		! PreheatFreshWater-4:Load side flow rate ->Inlet flow rate for port
93,1 		! Diverter-4:Temperature at outlet 1 ->Inlet temperature for HX
93,2 		! Diverter-4:Flow rate at outlet 1 ->Inlet flow rate for HX
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Edge loss temperature for node-4
0,0		! [unconnected] Edge loss temperature for node-5
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
0,0		! [unconnected] Auxiliary heat input for node-4
0,0		! [unconnected] Auxiliary heat input for node-5
0,0		! [unconnected] Miscellaneous heat input
*** INITIAL INPUT VALUES
20.0 0.0 20.0 0.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 0.0
0.0 0 
DERIVATIVES 5
20.0		! 1 Initial Tank Temperature-1
20.0		! 2 Initial Tank Temperature-2
20.0		! 3 Initial Tank Temperature-3
20.0		! 4 Initial Tank Temperature-4
20.0		! 5 Initial Tank Temperature-5
*------------------------------------------------------------------------------

* Model "Load_Tout-4" (Type 22)
* 

UNIT 101 TYPE 22	 Load_Tout-4
*$UNIT_NAME Load_Tout-4
*$MODEL .\Controllers\Iterative Feedback Controller\Type22.tmf
*$POSITION 621 1740
*$LAYER Main # 
PARAMETERS 2
0		! 1 mode
0		! 2 Maximum number of oscillations
INPUTS 7
Tload_4		! DHW flow_demand-4:Tload_4 ->Setpoint
100,1 		! AF3000-4:Temperature at outlet ->Controlled variable
0,0		! [unconnected] On / Off signal
0,0		! [unconnected] Minimum control signal
0,0		! [unconnected] Maximum control signal
0,0		! [unconnected] Threshold for non-zero output
0,0		! [unconnected] Tolerance on tracking error
*** INITIAL INPUT VALUES
58 0 1 0 1 0 0 
*------------------------------------------------------------------------------

* Model "PreheatFreshWater-4" (Type 91)
* 

UNIT 102 TYPE 91	 PreheatFreshWater-4
*$UNIT_NAME PreheatFreshWater-4
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 256 1967
*$LAYER Main # 
PARAMETERS 3
0		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
TankTempHot_4		! Heat _from_CHP-4:TankTempHot_4 ->Source side inlet temperature
TankFR_Hot_4		! Heat _from_CHP-4:TankFR_Hot_4 ->Source side flow rate
Tcold_4		! DHW flow_demand-4:Tcold_4 ->Load side inlet temperature
Demand_FR_4		! DHW flow_demand-4:Demand_FR_4 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "CHP controller-4" (Type 102)
* 

UNIT 103 TYPE 102	 CHP controller-4
*$UNIT_NAME CHP controller-4
*$MODEL .\Electrical\Diesel Engine (DEGS)\DEGS Dispatch Controller\Type102a.tmf
*$POSITION 1874 719
*$LAYER Main # 
PARAMETERS 5
1		! 1 Minimum number of DEGS in operation
1		! 2 Maximum number of DEGS in operation
250		! 3 DEGS rated power
0.4		! 4 Minimum turndown
1		! 5 Maximum power
INPUTS 1
PDEGSwlot_4		! Control-4:PDEGSwlot_4 ->Load power
*** INITIAL INPUT VALUES
500000 
*------------------------------------------------------------------------------

* EQUATIONS "Spaceheating-4"
* 
EQUATIONS 1
EnergyRateToDSH_4 = max(0,PthCHP-EnergyRatToDHW_4)
*$UNIT_NAME Spaceheating-4
*$LAYER Main
*$POSITION 1699 714

*------------------------------------------------------------------------------


* Model "CHP engine-4" (Type 120)
* 

UNIT 105 TYPE 120	 CHP engine-4
*$UNIT_NAME CHP engine-4
*$MODEL .\Electrical\Diesel Engine (DEGS)\Generic Model\Type120a.tmf
*$POSITION 1874 821
*$LAYER Main # 
*$# Generic Model DEGS
PARAMETERS 5
1		! 1 DEGS mode
5		! 2 DEGS fuel type
250		! 3 Maximum DEGS power
10		! 4 Minimum DEGS power
250		! 5 Rated power
INPUTS 3
wlacznikfinal_4		! Control-4:wlacznikfinal_4 ->DEGS on/off switch
103,1 		! CHP controller-4:Single DEG power ->DEGS power set point
103,2 		! CHP controller-4:Number of DEGS in operation ->Number of units on
*** INITIAL INPUT VALUES
1 300000 1 
*------------------------------------------------------------------------------

* EQUATIONS "Heat Production by CHP-4"
* 
EQUATIONS 4
PthCHP = GT([105,1],0)*(A*[105,1]+B*1000) 
A = 1.6668
B = 5.86345
PthCHPnom = GT(CHP_Pel_4,0)*(A*CHP_Pel_4+B*1000)    
*$UNIT_NAME Heat Production by CHP-4
*$LAYER Main
*$POSITION 1699 820

*------------------------------------------------------------------------------


* EQUATIONS "Control-4"
* 
EQUATIONS 10
Pload1_4 = max(([18,5]-[108,4]),0)
PDEGSmin_4 = 1*0.4*CHP_Pel_4
PDEGSmax_4 = 1*1*CHP_Pel_4
PDEGS_4 = max(Pload1_4,PDEGSmin_4)
PDEGSwlot_4 = min(PDEGSmax_4,PDEGS_4)
wlacznik_4 = GT(Pload1_4,0)*1+(1-GT(Pload1_4,0))*0
wlacznik1_4 = GT(Pload1_4,PDEGSmin_4)*1 + (1-GT(Pload1_4,PDEGSmin_4))*1
wlacznikfinal_4 = min(wlacznik_4,wlacznik_41)
CHP_Pel_4 = 30000
EnElBought_4 = max(0,Pel_demand-PV_production-PDEGSwlot_4) ! electric energy bought from net
*$UNIT_NAME Control-4
*$LAYER Main
*$POSITION 576 549

*------------------------------------------------------------------------------


* Model "1_PV-Inverter-4" (Type 194)
* 

UNIT 108 TYPE 194	 1_PV-Inverter-4
*$UNIT_NAME 1_PV-Inverter-4
*$MODEL .\Electrical\Photovoltaic Panels\With Inverter\Type194b.tmf
*$POSITION 697 549
*$LAYER Main # 
PARAMETERS 29
2		! 1 Mode
8.63		! 2 Module short-circuit current at reference conditions
37.68		! 3 Module open-circuit voltage at reference conditions
298		! 4 Reference temperature
1000		! 5 Reference insolation
30.93		! 6 Module voltage at max power point and reference conditions
8.08		! 7 Module current at max power point and reference conditions
0.07		! 8 Temperature coeficient of Isc at (ref. cond)
-0.34		! 9 Temperature coeficient of Voc (ref. cond.)
60		! 10 Number of cells wired in series
150		! 11 Number of modules in series
1		! 12 Number of modules in parallel
319		! 13 Module temperature at NOCT
293		! 14 Ambient temperature at NOCT
800		! 15 Insolation at NOCT
1.6		! 16 Module area
0.99		! 17 tau-alpha product for normal incidence
1.12		! 18 Semiconductor bandgap
1.9		! 19 Value of parameter "a" at reference conditions
5.4		! 20 Value of parameter I_L at reference conditions
0		! 21 Value of parametre I_0 at reference conditions
0.5		! 22 Module series resistance
45.81		! 23 Shunt resistance at reference conditions
0.008		! 24 Extinction coefficient-thickness product of cover
40800		! 25 Maximum inverter power
10000		! 26 Maximium inverter voltage
0		! 27 Minimum inverter voltage
0		! 28 Night tare
135		! 29 Logical unit number for inverter data
INPUTS 10
109,24 		! 1-4:Total tilted surface radiation for surface ->Total incident radiation on tilted surface
109,1 		! 1-4:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Load voltage
109,30 		! 1-4:Slope of surface ->Array slope
109,25 		! 1-4:Beam radiation for surface ->Beam radiation on tilted surface
109,26 		! 1-4:Sky diffuse radiation for surface ->Sky diffuse radiation on tilted surface
109,27 		! 1-4:Ground reflected diffuse radiation for surface ->Ground diffuse radiation on tilted surface
109,29 		! 1-4:Angle of incidence for surface ->Incidence angle on tilted surface
109,16 		! 1-4:Solar zenith angle ->Solar zenith angle
109,8 		! 1-4:Wind velocity ->Wind speed
*** INITIAL INPUT VALUES
0 0 0 0 0 0 0 0 0 0 
*** External files
ASSIGN "C:\Dysk Google\CHP model\Type194-inverter.dat" 135
*|? What file contains the inverter parameters? |1000
*------------------------------------------------------------------------------

* Model "1-4" (Type 15)
* 

UNIT 109 TYPE 15	 1-4
*$UNIT_NAME 1-4
*$MODEL .\Weather Data Reading and Processing\Standard Format\TMY2\Type15-2.tmf
*$POSITION 815 547
*$LAYER Main # 
PARAMETERS 9
2		! 1 File Type
136		! 2 Logical unit
5		! 3 Tilted Surface Radiation Mode
0.2		! 4 Ground reflectance - no snow
0.7		! 5 Ground reflectance - snow cover
1		! 6 Number of surfaces
1		! 7 Tracking mode
45		! 8 Slope of surface
0		! 9 Azimuth of surface
*** External files
ASSIGN "C:\TRNSYS17\Weather\Meteonorm\Europe\PL-Warszawa-123750.tm2" 136
*|? Which file contains the TMY-2 weather data? |1000
*------------------------------------------------------------------------------

* Model "SH_HX3-5" (Type 91)
* 

UNIT 110 TYPE 91	 SH_HX3-5
*$UNIT_NAME SH_HX3-5
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 629 3432
*$LAYER Main # 
PARAMETERS 3
0.6		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
115,1 		! TeePiece-5:Outlet temperature ->Source side inlet temperature
115,2 		! TeePiece-5:Outlet flow rate ->Source side flow rate
Tin_to_HX3_5		! SH_calc-5:Tin_to_HX3_5 ->Load side inlet temperature
FR_to_HX3_5		! SH_calc-5:FR_to_HX3_5 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* EQUATIONS "SH_calc-5"
* 
EQUATIONS 6
Tin_to_HX3_5 = 55 ! °C
FR_to_HX3_5 = (Q_sh_corr_5)/((max(1,(4.19*(abs(Tset_to_SH_5-Tin_to_HX3_5))))))*3.6 ! delta T is implicit but parameters should be 70/55°C so delta is 15°C
Tset_to_SH_5 = 70 !°C
Q_HX3_5 = [115,2]*4.19*max(0,abs(([115,1] - [110,1])))/3.6
Q_sh_corr_5 = min(Q_HX3_5,[45,5])
SH_HX3_rate_kW = [110,5]/3.6 !kWh/h
*$UNIT_NAME SH_calc-5
*$LAYER Main
*$POSITION 635 3554

*------------------------------------------------------------------------------


* EQUATIONS "Substation-5"
* 
EQUATIONS 4
ThotNet_5 = 90
msource_5 = [113,4]
kWhFromSubstToDHW_5 = [113,5]/3.6
kWhDryCooler_5 = [116,3]/3.6
*$UNIT_NAME Substation-5
*$LAYER Main
*$POSITION 116 3327

*------------------------------------------------------------------------------


* Model "PostHeatCHPout-5" (Type 91)
* 

UNIT 113 TYPE 91	 PostHeatCHPout-5
*$UNIT_NAME PostHeatCHPout-5
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 256 3327
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
ThotNet_5		! Substation-5:ThotNet_5 ->Source side inlet temperature
msource_5		! Substation-5:msource_5 ->Source side flow rate
123,1 		! PreheatFreshWater-5:Source-side outlet temperature ->Load side inlet temperature
123,2 		! PreheatFreshWater-5:Source side flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "Diverter-5" (Type 11)
* 

UNIT 114 TYPE 11	 Diverter-5
*$UNIT_NAME Diverter-5
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 530 3327
*$LAYER Water Loop # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
113,3 		! PostHeatCHPout-5:Load side outlet temperature ->Inlet temperature
113,4 		! PostHeatCHPout-5:Load side flow rate ->Inlet flow rate
122,1 		! Load_Tout-5:Control signal ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 1 
*------------------------------------------------------------------------------

* Model "TeePiece-5" (Type 11)
* 

UNIT 115 TYPE 11	 TeePiece-5
*$UNIT_NAME TeePiece-5
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 698 3274
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
121,20 		! AF3000-5:Temperature at HX Outlet ->Temperature at inlet 1
121,21 		! AF3000-5:HX flow rate ->Flow rate at inlet 1
114,3 		! Diverter-5:Temperature at outlet 2 ->Temperature at inlet 2
114,4 		! Diverter-5:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "DryCooler-5" (Type 511)
* 

UNIT 116 TYPE 511	 DryCooler-5
*$UNIT_NAME DryCooler-5
*$MODEL .\HVAC Library (TESS)\Dry Fluid Cooler\Type511.tmf
*$POSITION 224 3434
*$LAYER Main # 
*$# DRY FLUID COOLER
PARAMETERS 11
1		! 1 Heat exchanger mode
70		! 2 Design inlet fluid temperature
60		! 3 Design outlet fluid temperature
5678.12		! 4 Design fluid flow rate
4.190		! 5 Fluid specific heat
28.0		! 6 Design ambient air temperature
5678.12		! 7 Design air flow rate
5369.04		! 8 Rated fan power
10.0		! 9 Ratio of liquid h to air h
1		! 10 Number of power coefficients
1		! 11 Power coefficient
INPUTS 5
110,1 		! SH_HX3-5:Source-side outlet temperature ->Fluid inlet temperature
110,2 		! SH_HX3-5:Source side flow rate ->Fluid flow rate
130,1 		! 1-5:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Fan control signal
0,0		! [unconnected] Desired outlet temperature
*** INITIAL INPUT VALUES
10.0 0.0 20.0 -1 70 
*------------------------------------------------------------------------------

* EQUATIONS "DHW flow_demand-5"
* 
EQUATIONS 4
Demand_FR_5 = ((0.001*[23,5])/(4.19*(Tload_5-Tcold_5)))*3600
Tcold_5 = 15
Tload_5 = 60
T_hotNet_5 = 90
*$UNIT_NAME DHW flow_demand-5
*$LAYER Main
*$POSITION 256 3132

*------------------------------------------------------------------------------


* EQUATIONS "Heat _from_CHP-5"
* 
EQUATIONS 2
TankTempHot_5 = max(GT(PthCHP,0)*(20+[116,1]),[116,1])
TankFR_Hot_5 = [120,2]
*$UNIT_NAME Heat _from_CHP-5
*$LAYER Main
*$POSITION 137 3021

*------------------------------------------------------------------------------


* EQUATIONS "DHW Energy rates-5"
* 
EQUATIONS 6
EnergyRatFromCHP_5 = 1000*PumpSignal*4.19*[120,2]*(TankTempHot_5-[121,20])/3600
EnergyRatToDHW_5 = 1000*([121,5]+[123,5])/3600
PumpFR_5 = max(0.7*PumpFRnom_5,(3.6*PthCHP)/(20*4.19))
PumpFRnom_5 = (3.6*PthCHPnom)/(20*4.19)
Pumpsignal_5 = min(1,PumpFR_5/PumpFRnom_5)
CHPTdelta_5 = TankTempHot_5-[121,20]
*$UNIT_NAME DHW Energy rates-5
*$LAYER Main
*$POSITION 408 3083

*------------------------------------------------------------------------------


* Model "CHP_Recirc_pump-5" (Type 110)
* 

UNIT 120 TYPE 110	 CHP_Recirc_pump-5
*$UNIT_NAME CHP_Recirc_pump-5
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 411 2981
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
2040		! 1 Rated flow rate
4.19		! 2 Fluid specific heat
2684.0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1		! 6 Power coefficient
INPUTS 5
0,0		! [unconnected] Inlet fluid temperature
0,0		! [unconnected] Inlet fluid flow rate
Pumpsignal_5		! DHW Energy rates-5:Pumpsignal_5 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
20.0 0.0 1 0.7 0.9 
*------------------------------------------------------------------------------

* Model "AF3000-5" (Type 534)
* 

UNIT 121 TYPE 534	 AF3000-5
*$UNIT_NAME AF3000-5
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\Coiled Tube HXs\Type534-Coiled.tmf
*$POSITION 525 3234
*$LAYER Main # 
*$# Cylindrical Storage Tank
PARAMETERS 60
-1		! 1 LU for data file
5		! 2 Number of tank nodes
1		! 3 Number of ports
1		! 4 Number of immersed heat exchangers
1		! 5 Number of miscellaneous heat flows
3		! 6 Tank volume
1.5		! 7 Tank height
0		! 8 Tank fluid
4.19		! 9 Fluid specific heat
1000		! 10 Fluid density
2.14		! 11 Fluid thermal conductivity
3.21		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
5.0		! 14 Top loss coefficient
5.0		! 15 Edge loss coefficient for node-1
5.0		! 16 Edge loss coefficient for node-2
5.0		! 17 Edge loss coefficient for node-3
5.0		! 18 Edge loss coefficient for node-4
5.0		! 19 Edge loss coefficient for node-5
5.0		! 20 Bottom loss coefficient
0		! 21 Additional thermal conductivity
1		! 22 Inlet flow mode
1		! 23 Entry node
1		! 24 Exit node
3.0		! 25 Flue loss coefficient for node-1
3.0		! 26 Flue loss coefficient for node-2
3.0		! 27 Flue loss coefficient for node-3
3.0		! 28 Flue loss coefficient for node-4
3.0		! 29 Flue loss coefficient for node-5
1		! 30 Node for miscellaneous heat gain
3		! 31 Type of HX
5		! 32 Number of HX nodes
0		! 33 HX fluid
4.19		! 34 HX fluid specific heat
1000		! 35 HX fluid density
2.14		! 36 HX fluid thermal conductivity
3.21		! 37 HX fluid viscosity
0.6		! 38 Multiplier for natural convection
0.25		! 39 Exponent for natural convection
1.0		! 40 Geometry factor for natural convection
1.0		! 41 Geometry exponent for natural convection
0.035		! 42 Inner tube diameter
0.036505		! 43 Outer tube diameter
2.14		! 44 HX wall thermal conductivity
83		! 45 Length of HX tubes
1		! 46 Number of tubes
0		! 47 HX header volume
0.05		! 48 HX cross sectional area
1		! 49 Coil diameter
0.05		! 50 Coil pitch
1		! 51 Tank node for HX node-1
0.2		! 52 Fraction of HX length-1
1		! 53 Tank node for HX node-2
0.2		! 54 Fraction of HX length-2
1		! 55 Tank node for HX node-3
0.2		! 56 Fraction of HX length-3
1		! 57 Tank node for HX node-4
0.2		! 58 Fraction of HX length-4
1		! 59 Tank node for HX node-5
0.2		! 60 Fraction of HX length-5
INPUTS 19
123,3 		! PreheatFreshWater-5:Load side outlet temperature ->Inlet temperature for port
123,4 		! PreheatFreshWater-5:Load side flow rate ->Inlet flow rate for port
114,1 		! Diverter-5:Temperature at outlet 1 ->Inlet temperature for HX
114,2 		! Diverter-5:Flow rate at outlet 1 ->Inlet flow rate for HX
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Edge loss temperature for node-4
0,0		! [unconnected] Edge loss temperature for node-5
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
0,0		! [unconnected] Auxiliary heat input for node-4
0,0		! [unconnected] Auxiliary heat input for node-5
0,0		! [unconnected] Miscellaneous heat input
*** INITIAL INPUT VALUES
20.0 0.0 20.0 0.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 0.0
0.0 0 
DERIVATIVES 5
20.0		! 1 Initial Tank Temperature-1
20.0		! 2 Initial Tank Temperature-2
20.0		! 3 Initial Tank Temperature-3
20.0		! 4 Initial Tank Temperature-4
20.0		! 5 Initial Tank Temperature-5
*------------------------------------------------------------------------------

* Model "Load_Tout-5" (Type 22)
* 

UNIT 122 TYPE 22	 Load_Tout-5
*$UNIT_NAME Load_Tout-5
*$MODEL .\Controllers\Iterative Feedback Controller\Type22.tmf
*$POSITION 621 3007
*$LAYER Main # 
PARAMETERS 2
0		! 1 mode
0		! 2 Maximum number of oscillations
INPUTS 7
Tload_5		! DHW flow_demand-5:Tload_5 ->Setpoint
121,1 		! AF3000-5:Temperature at outlet ->Controlled variable
0,0		! [unconnected] On / Off signal
0,0		! [unconnected] Minimum control signal
0,0		! [unconnected] Maximum control signal
0,0		! [unconnected] Threshold for non-zero output
0,0		! [unconnected] Tolerance on tracking error
*** INITIAL INPUT VALUES
58 0 1 0 1 0 0 
*------------------------------------------------------------------------------

* Model "PreheatFreshWater-5" (Type 91)
* 

UNIT 123 TYPE 91	 PreheatFreshWater-5
*$UNIT_NAME PreheatFreshWater-5
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 256 3234
*$LAYER Main # 
PARAMETERS 3
0		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
TankTempHot_5		! Heat _from_CHP-5:TankTempHot_5 ->Source side inlet temperature
TankFR_Hot_5		! Heat _from_CHP-5:TankFR_Hot_5 ->Source side flow rate
Tcold_5		! DHW flow_demand-5:Tcold_5 ->Load side inlet temperature
Demand_FR_5		! DHW flow_demand-5:Demand_FR_5 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "CHP controller-5" (Type 102)
* 

UNIT 124 TYPE 102	 CHP controller-5
*$UNIT_NAME CHP controller-5
*$MODEL .\Electrical\Diesel Engine (DEGS)\DEGS Dispatch Controller\Type102a.tmf
*$POSITION 1887 946
*$LAYER Main # 
PARAMETERS 5
1		! 1 Minimum number of DEGS in operation
1		! 2 Maximum number of DEGS in operation
250		! 3 DEGS rated power
0.4		! 4 Minimum turndown
1		! 5 Maximum power
INPUTS 1
PDEGSwlot_5		! Control-5:PDEGSwlot_5 ->Load power
*** INITIAL INPUT VALUES
500000 
*------------------------------------------------------------------------------

* EQUATIONS "Spaceheating-5"
* 
EQUATIONS 1
EnergyRateToDSH_5 = max(0,PthCHP-EnergyRatToDHW_5)
*$UNIT_NAME Spaceheating-5
*$LAYER Main
*$POSITION 1712 941

*------------------------------------------------------------------------------


* Model "CHP engine-5" (Type 120)
* 

UNIT 126 TYPE 120	 CHP engine-5
*$UNIT_NAME CHP engine-5
*$MODEL .\Electrical\Diesel Engine (DEGS)\Generic Model\Type120a.tmf
*$POSITION 1887 1048
*$LAYER Main # 
*$# Generic Model DEGS
PARAMETERS 5
1		! 1 DEGS mode
5		! 2 DEGS fuel type
250		! 3 Maximum DEGS power
10		! 4 Minimum DEGS power
250		! 5 Rated power
INPUTS 3
wlacznikfinal_5		! Control-5:wlacznikfinal_5 ->DEGS on/off switch
124,1 		! CHP controller-5:Single DEG power ->DEGS power set point
124,2 		! CHP controller-5:Number of DEGS in operation ->Number of units on
*** INITIAL INPUT VALUES
1 300000 1 
*------------------------------------------------------------------------------

* EQUATIONS "Heat Production by CHP-5"
* 
EQUATIONS 4
PthCHP = GT([126,1],0)*(A*[126,1]+B*1000) 
A = 1.6668
B = 5.86345
PthCHPnom = GT(CHP_Pel_5,0)*(A*CHP_Pel_5+B*1000)    
*$UNIT_NAME Heat Production by CHP-5
*$LAYER Main
*$POSITION 1712 1047

*------------------------------------------------------------------------------


* EQUATIONS "Control-5"
* 
EQUATIONS 10
Pload1_5 = max(([18,6]-[129,4]),0)
PDEGSmin_5 = 1*0.4*CHP_Pel_5
PDEGSmax_5 = 1*1*CHP_Pel_5
PDEGS_5 = max(Pload1_5,PDEGSmin_5)
PDEGSwlot_5 = min(PDEGSmax_5,PDEGS_5)
wlacznik_5 = GT(Pload1_5,0)*1+(1-GT(Pload1_5,0))*0
wlacznik1_5 = GT(Pload1_5,PDEGSmin_5)*1 + (1-GT(Pload1_5,PDEGSmin_5))*1
wlacznikfinal_5 = min(wlacznik_5,wlacznik_51)
CHP_Pel_5 = 25000
EnElBought_5 = max(0,[18,6]-[129,4]-PDEGSwlot_5) ! electric energy bought from net
*$UNIT_NAME Control-5
*$LAYER Main
*$POSITION 575 630

*------------------------------------------------------------------------------


* Model "1_PV-Inverter-5" (Type 194)
* 

UNIT 129 TYPE 194	 1_PV-Inverter-5
*$UNIT_NAME 1_PV-Inverter-5
*$MODEL .\Electrical\Photovoltaic Panels\With Inverter\Type194b.tmf
*$POSITION 697 630
*$LAYER Main # 
PARAMETERS 29
2		! 1 Mode
8.63		! 2 Module short-circuit current at reference conditions
37.68		! 3 Module open-circuit voltage at reference conditions
298		! 4 Reference temperature
1000		! 5 Reference insolation
30.93		! 6 Module voltage at max power point and reference conditions
8.08		! 7 Module current at max power point and reference conditions
0.07		! 8 Temperature coeficient of Isc at (ref. cond)
-0.34		! 9 Temperature coeficient of Voc (ref. cond.)
60		! 10 Number of cells wired in series
77		! 11 Number of modules in series
1		! 12 Number of modules in parallel
319		! 13 Module temperature at NOCT
293		! 14 Ambient temperature at NOCT
800		! 15 Insolation at NOCT
1.6		! 16 Module area
0.99		! 17 tau-alpha product for normal incidence
1.12		! 18 Semiconductor bandgap
1.9		! 19 Value of parameter "a" at reference conditions
5.4		! 20 Value of parameter I_L at reference conditions
0		! 21 Value of parametre I_0 at reference conditions
0.5		! 22 Module series resistance
45.81		! 23 Shunt resistance at reference conditions
0.008		! 24 Extinction coefficient-thickness product of cover
40800		! 25 Maximum inverter power
10000		! 26 Maximium inverter voltage
0		! 27 Minimum inverter voltage
0		! 28 Night tare
137		! 29 Logical unit number for inverter data
INPUTS 10
130,24 		! 1-5:Total tilted surface radiation for surface ->Total incident radiation on tilted surface
130,1 		! 1-5:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Load voltage
130,30 		! 1-5:Slope of surface ->Array slope
130,25 		! 1-5:Beam radiation for surface ->Beam radiation on tilted surface
130,26 		! 1-5:Sky diffuse radiation for surface ->Sky diffuse radiation on tilted surface
130,27 		! 1-5:Ground reflected diffuse radiation for surface ->Ground diffuse radiation on tilted surface
130,29 		! 1-5:Angle of incidence for surface ->Incidence angle on tilted surface
130,16 		! 1-5:Solar zenith angle ->Solar zenith angle
130,8 		! 1-5:Wind velocity ->Wind speed
*** INITIAL INPUT VALUES
0 0 0 0 0 0 0 0 0 0 
*** External files
ASSIGN "C:\Dysk Google\CHP model\Type194-inverter.dat" 137
*|? What file contains the inverter parameters? |1000
*------------------------------------------------------------------------------

* Model "1-5" (Type 15)
* 

UNIT 130 TYPE 15	 1-5
*$UNIT_NAME 1-5
*$MODEL .\Weather Data Reading and Processing\Standard Format\TMY2\Type15-2.tmf
*$POSITION 814 628
*$LAYER Main # 
PARAMETERS 9
2		! 1 File Type
138		! 2 Logical unit
5		! 3 Tilted Surface Radiation Mode
0.2		! 4 Ground reflectance - no snow
0.7		! 5 Ground reflectance - snow cover
1		! 6 Number of surfaces
1		! 7 Tracking mode
45		! 8 Slope of surface
0		! 9 Azimuth of surface
*** External files
ASSIGN "C:\TRNSYS17\Weather\Meteonorm\Europe\PL-Warszawa-123750.tm2" 138
*|? Which file contains the TMY-2 weather data? |1000
*------------------------------------------------------------------------------

* Model "CHP controller-6" (Type 102)
* 

UNIT 145 TYPE 102	 CHP controller-6
*$UNIT_NAME CHP controller-6
*$MODEL .\Electrical\Diesel Engine (DEGS)\DEGS Dispatch Controller\Type102a.tmf
*$POSITION 1861 999
*$LAYER Main # 
PARAMETERS 5
1		! 1 Minimum number of DEGS in operation
1		! 2 Maximum number of DEGS in operation
250		! 3 DEGS rated power
0.4		! 4 Minimum turndown
1		! 5 Maximum power
INPUTS 1
PDEGSwlot_6		! Control-6:PDEGSwlot_6 ->Load power
*** INITIAL INPUT VALUES
500000 
*------------------------------------------------------------------------------

* EQUATIONS "Spaceheating-6"
* 
EQUATIONS 1
EnergyRateToDSH_6 = max(0,PthCHP-EnergyRateToDHW)
*$UNIT_NAME Spaceheating-6
*$LAYER Main
*$POSITION 1686 994

*------------------------------------------------------------------------------


* Model "CHP engine-6" (Type 120)
* 

UNIT 147 TYPE 120	 CHP engine-6
*$UNIT_NAME CHP engine-6
*$MODEL .\Electrical\Diesel Engine (DEGS)\Generic Model\Type120a.tmf
*$POSITION 1861 1101
*$LAYER Main # 
*$# Generic Model DEGS
PARAMETERS 5
1		! 1 DEGS mode
5		! 2 DEGS fuel type
250		! 3 Maximum DEGS power
10		! 4 Minimum DEGS power
250		! 5 Rated power
INPUTS 3
wlacznik1_6		! Control-6:wlacznik1_6 ->DEGS on/off switch
145,1 		! CHP controller-6:Single DEG power ->DEGS power set point
145,2 		! CHP controller-6:Number of DEGS in operation ->Number of units on
*** INITIAL INPUT VALUES
1 300000 1 
*------------------------------------------------------------------------------

* EQUATIONS "Heat Production by CHP-6"
* 
EQUATIONS 4
PthCHP = GT([147,1],0)*(A*[147,1]+B*1000) 
A = 1.6668
B = 5.86345
PthCHPnom = GT(CHP_Pel_6,0)*(A*CHP_Pel_6+B*1000)    
*$UNIT_NAME Heat Production by CHP-6
*$LAYER Main
*$POSITION 1686 1100

*------------------------------------------------------------------------------


* EQUATIONS "Control-6"
* 
EQUATIONS 10
Pload1_6 = max(([18,7]-[150,4]),0)
PDEGSmin_6 = 1*0.4*CHP_Pel_6
PDEGSmax_6 = 1*1*CHP_Pel_6
PDEGS_6 = max(Pload1_6,PDEGSmin_6)
PDEGSwlot_6 = min(PDEGSmax_6,PDEGS_6)
wlacznik_6 = GT(Pload1_6,0)*1+(1-GT(Pload1_6,0))*0
wlacznik1_6 = GT(Pload1_6,PDEGSmin_6)*1 + (1-GT(Pload1_6,PDEGSmin_6))*1
wlacznikfinal_6 = min(wlacznik_6,wlacznik_61)
CHP_Pel_6 = 30000
EnElBought_6 = max(0,Pel_demand-PV_production-PDEGSwlot_6) ! electric energy bought from net
*$UNIT_NAME Control-6
*$LAYER Main
*$POSITION 569 709

*------------------------------------------------------------------------------


* Model "1_PV-Inverter-6" (Type 194)
* 

UNIT 150 TYPE 194	 1_PV-Inverter-6
*$UNIT_NAME 1_PV-Inverter-6
*$MODEL .\Electrical\Photovoltaic Panels\With Inverter\Type194b.tmf
*$POSITION 691 709
*$LAYER Main # 
PARAMETERS 29
2		! 1 Mode
8.63		! 2 Module short-circuit current at reference conditions
37.68		! 3 Module open-circuit voltage at reference conditions
298		! 4 Reference temperature
1000		! 5 Reference insolation
30.93		! 6 Module voltage at max power point and reference conditions
8.08		! 7 Module current at max power point and reference conditions
0.07		! 8 Temperature coeficient of Isc at (ref. cond)
-0.34		! 9 Temperature coeficient of Voc (ref. cond.)
60		! 10 Number of cells wired in series
132		! 11 Number of modules in series
1		! 12 Number of modules in parallel
154		! 13 Module temperature at NOCT
293		! 14 Ambient temperature at NOCT
800		! 15 Insolation at NOCT
1.6		! 16 Module area
0.99		! 17 tau-alpha product for normal incidence
1.12		! 18 Semiconductor bandgap
1.9		! 19 Value of parameter "a" at reference conditions
5.4		! 20 Value of parameter I_L at reference conditions
0		! 21 Value of parametre I_0 at reference conditions
0.5		! 22 Module series resistance
45.81		! 23 Shunt resistance at reference conditions
0.008		! 24 Extinction coefficient-thickness product of cover
40800		! 25 Maximum inverter power
10000		! 26 Maximium inverter voltage
0		! 27 Minimum inverter voltage
0		! 28 Night tare
139		! 29 Logical unit number for inverter data
INPUTS 10
151,24 		! 1-6:Total tilted surface radiation for surface ->Total incident radiation on tilted surface
151,1 		! 1-6:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Load voltage
151,30 		! 1-6:Slope of surface ->Array slope
151,25 		! 1-6:Beam radiation for surface ->Beam radiation on tilted surface
151,26 		! 1-6:Sky diffuse radiation for surface ->Sky diffuse radiation on tilted surface
151,27 		! 1-6:Ground reflected diffuse radiation for surface ->Ground diffuse radiation on tilted surface
151,29 		! 1-6:Angle of incidence for surface ->Incidence angle on tilted surface
151,16 		! 1-6:Solar zenith angle ->Solar zenith angle
151,8 		! 1-6:Wind velocity ->Wind speed
*** INITIAL INPUT VALUES
0 0 0 0 0 0 0 0 0 0 
*** External files
ASSIGN "C:\Dysk Google\CHP model\Type194-inverter.dat" 139
*|? What file contains the inverter parameters? |1000
*------------------------------------------------------------------------------

* Model "1-6" (Type 15)
* 

UNIT 151 TYPE 15	 1-6
*$UNIT_NAME 1-6
*$MODEL .\Weather Data Reading and Processing\Standard Format\TMY2\Type15-2.tmf
*$POSITION 808 707
*$LAYER Main # 
PARAMETERS 9
2		! 1 File Type
140		! 2 Logical unit
5		! 3 Tilted Surface Radiation Mode
0.2		! 4 Ground reflectance - no snow
0.7		! 5 Ground reflectance - snow cover
1		! 6 Number of surfaces
1		! 7 Tracking mode
45		! 8 Slope of surface
0		! 9 Azimuth of surface
*** External files
ASSIGN "C:\TRNSYS17\Weather\Meteonorm\Europe\PL-Warszawa-123750.tm2" 140
*|? Which file contains the TMY-2 weather data? |1000
*------------------------------------------------------------------------------

* Model "CHP controller-7" (Type 102)
* 

UNIT 166 TYPE 102	 CHP controller-7
*$UNIT_NAME CHP controller-7
*$MODEL .\Electrical\Diesel Engine (DEGS)\DEGS Dispatch Controller\Type102a.tmf
*$POSITION 1901 1452
*$LAYER Main # 
PARAMETERS 5
1		! 1 Minimum number of DEGS in operation
1		! 2 Maximum number of DEGS in operation
250		! 3 DEGS rated power
0.4		! 4 Minimum turndown
1		! 5 Maximum power
INPUTS 1
PDEGSwlot_7		! Control-7:PDEGSwlot_7 ->Load power
*** INITIAL INPUT VALUES
500000 
*------------------------------------------------------------------------------

* EQUATIONS "Spaceheating-7"
* 
EQUATIONS 1
EnergyRateToDSH_7 = max(0,PthCHP-EnergyRateToDHW)
*$UNIT_NAME Spaceheating-7
*$LAYER Main
*$POSITION 1726 1447

*------------------------------------------------------------------------------


* Model "CHP engine-7" (Type 120)
* 

UNIT 168 TYPE 120	 CHP engine-7
*$UNIT_NAME CHP engine-7
*$MODEL .\Electrical\Diesel Engine (DEGS)\Generic Model\Type120a.tmf
*$POSITION 1901 1554
*$LAYER Main # 
*$# Generic Model DEGS
PARAMETERS 5
1		! 1 DEGS mode
5		! 2 DEGS fuel type
250		! 3 Maximum DEGS power
10		! 4 Minimum DEGS power
250		! 5 Rated power
INPUTS 3
wlacznikfinal_7		! Control-7:wlacznikfinal_7 ->DEGS on/off switch
166,1 		! CHP controller-7:Single DEG power ->DEGS power set point
166,2 		! CHP controller-7:Number of DEGS in operation ->Number of units on
*** INITIAL INPUT VALUES
1 300000 1 
*------------------------------------------------------------------------------

* EQUATIONS "Heat Production by CHP-7"
* 
EQUATIONS 4
PthCHP = GT([168,1],0)*(A*[168,1]+B*1000) 
A = 1.6668
B = 5.86345
PthCHPnom = GT(CHP_Pel_7,0)*(A*CHP_Pel_7+B*1000)    
*$UNIT_NAME Heat Production by CHP-7
*$LAYER Main
*$POSITION 1726 1553

*------------------------------------------------------------------------------


* EQUATIONS "Control-7"
* 
EQUATIONS 10
Pload1_7 = max(([18,8]-[171,4]),0)
PDEGSmin_7 = 1*0.4*CHP_Pel_7
PDEGSmax_7 = 1*1*CHP_Pel_7
PDEGS_7 = max(Pload1_7,PDEGSmin_7)
PDEGSwlot_7 = min(PDEGSmax_7,PDEGS_7)
wlacznik_7 = GT(Pload1_7,0)*1+(1-GT(Pload1_7,0))*0
wlacznik1_7 = GT(Pload1_7,PDEGSmin_7)*1 + (1-GT(Pload1_7,PDEGSmin_7))*1
wlacznikfinal_7 = min(wlacznik_7,wlacznik_71)
CHP_Pel_7 = 27500
EnElBought_7 = max(0,[18,8]-[171,4]-PDEGSwlot_7) ! electric energy bought from net
*$UNIT_NAME Control-7
*$LAYER Main
*$POSITION 568 790

*------------------------------------------------------------------------------


* Model "1_PV-Inverter-7" (Type 194)
* 

UNIT 171 TYPE 194	 1_PV-Inverter-7
*$UNIT_NAME 1_PV-Inverter-7
*$MODEL .\Electrical\Photovoltaic Panels\With Inverter\Type194b.tmf
*$POSITION 690 790
*$LAYER Main # 
PARAMETERS 29
2		! 1 Mode
8.63		! 2 Module short-circuit current at reference conditions
37.68		! 3 Module open-circuit voltage at reference conditions
298		! 4 Reference temperature
1000		! 5 Reference insolation
30.93		! 6 Module voltage at max power point and reference conditions
8.08		! 7 Module current at max power point and reference conditions
0.07		! 8 Temperature coeficient of Isc at (ref. cond)
-0.34		! 9 Temperature coeficient of Voc (ref. cond.)
60		! 10 Number of cells wired in series
140		! 11 Number of modules in series
1		! 12 Number of modules in parallel
319		! 13 Module temperature at NOCT
293		! 14 Ambient temperature at NOCT
800		! 15 Insolation at NOCT
1.6		! 16 Module area
0.99		! 17 tau-alpha product for normal incidence
1.12		! 18 Semiconductor bandgap
1.9		! 19 Value of parameter "a" at reference conditions
5.4		! 20 Value of parameter I_L at reference conditions
0		! 21 Value of parametre I_0 at reference conditions
0.5		! 22 Module series resistance
45.81		! 23 Shunt resistance at reference conditions
0.008		! 24 Extinction coefficient-thickness product of cover
40800		! 25 Maximum inverter power
10000		! 26 Maximium inverter voltage
0		! 27 Minimum inverter voltage
0		! 28 Night tare
141		! 29 Logical unit number for inverter data
INPUTS 10
172,24 		! 1-7:Total tilted surface radiation for surface ->Total incident radiation on tilted surface
172,1 		! 1-7:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Load voltage
172,30 		! 1-7:Slope of surface ->Array slope
172,25 		! 1-7:Beam radiation for surface ->Beam radiation on tilted surface
172,26 		! 1-7:Sky diffuse radiation for surface ->Sky diffuse radiation on tilted surface
172,27 		! 1-7:Ground reflected diffuse radiation for surface ->Ground diffuse radiation on tilted surface
172,29 		! 1-7:Angle of incidence for surface ->Incidence angle on tilted surface
172,16 		! 1-7:Solar zenith angle ->Solar zenith angle
172,8 		! 1-7:Wind velocity ->Wind speed
*** INITIAL INPUT VALUES
0 0 0 0 0 0 0 0 0 0 
*** External files
ASSIGN "C:\Dysk Google\CHP model\Type194-inverter.dat" 141
*|? What file contains the inverter parameters? |1000
*------------------------------------------------------------------------------

* Model "1-7" (Type 15)
* 

UNIT 172 TYPE 15	 1-7
*$UNIT_NAME 1-7
*$MODEL .\Weather Data Reading and Processing\Standard Format\TMY2\Type15-2.tmf
*$POSITION 807 788
*$LAYER Main # 
PARAMETERS 9
2		! 1 File Type
142		! 2 Logical unit
5		! 3 Tilted Surface Radiation Mode
0.2		! 4 Ground reflectance - no snow
0.7		! 5 Ground reflectance - snow cover
1		! 6 Number of surfaces
1		! 7 Tracking mode
45		! 8 Slope of surface
0		! 9 Azimuth of surface
*** External files
ASSIGN "C:\TRNSYS17\Weather\Meteonorm\Europe\PL-Warszawa-123750.tm2" 142
*|? Which file contains the TMY-2 weather data? |1000
*------------------------------------------------------------------------------

* Model "CHP controller-8" (Type 102)
* 

UNIT 187 TYPE 102	 CHP controller-8
*$UNIT_NAME CHP controller-8
*$MODEL .\Electrical\Diesel Engine (DEGS)\DEGS Dispatch Controller\Type102a.tmf
*$POSITION 1887 1652
*$LAYER Main # 
PARAMETERS 5
1		! 1 Minimum number of DEGS in operation
1		! 2 Maximum number of DEGS in operation
250		! 3 DEGS rated power
0.4		! 4 Minimum turndown
1		! 5 Maximum power
INPUTS 1
PDEGSwlot_8		! Control-8:PDEGSwlot_8 ->Load power
*** INITIAL INPUT VALUES
500000 
*------------------------------------------------------------------------------

* EQUATIONS "Spaceheating-8"
* 
EQUATIONS 1
EnergyRateToDSH_8 = max(0,PthCHP-EnergyRateToDHW)
*$UNIT_NAME Spaceheating-8
*$LAYER Main
*$POSITION 1712 1647

*------------------------------------------------------------------------------


* Model "CHP engine-8" (Type 120)
* 

UNIT 189 TYPE 120	 CHP engine-8
*$UNIT_NAME CHP engine-8
*$MODEL .\Electrical\Diesel Engine (DEGS)\Generic Model\Type120a.tmf
*$POSITION 1887 1754
*$LAYER Main # 
*$# Generic Model DEGS
PARAMETERS 5
1		! 1 DEGS mode
5		! 2 DEGS fuel type
250		! 3 Maximum DEGS power
10		! 4 Minimum DEGS power
250		! 5 Rated power
INPUTS 3
wlacznikfinal_8		! Control-8:wlacznikfinal_8 ->DEGS on/off switch
187,1 		! CHP controller-8:Single DEG power ->DEGS power set point
187,2 		! CHP controller-8:Number of DEGS in operation ->Number of units on
*** INITIAL INPUT VALUES
1 300000 1 
*------------------------------------------------------------------------------

* EQUATIONS "Heat Production by CHP-8"
* 
EQUATIONS 4
PthCHP = GT([189,1],0)*(A*[189,1]+B*1000) 
A = 1.6668
B = 5.86345
PthCHPnom = GT(CHP_Pel_8,0)*(A*CHP_Pel_8+B*1000)    
*$UNIT_NAME Heat Production by CHP-8
*$LAYER Main
*$POSITION 1712 1753

*------------------------------------------------------------------------------


* EQUATIONS "Control-8"
* 
EQUATIONS 10
Pload1_8 = max(([18,9]-[192,4]),0)
PDEGSmin_8 = 1*0.4*CHP_Pel_8
PDEGSmax_8 = 1*1*CHP_Pel_8
PDEGS_8 = max(Pload1_8,PDEGSmin_8)
PDEGSwlot_8 = min(PDEGSmax_8,PDEGS_8)
wlacznik_8 = GT(Pload1_8,0)*1+(1-GT(Pload1_8,0))*0
wlacznik1_8 = GT(Pload1_8,PDEGSmin_8)*1 + (1-GT(Pload1_8,PDEGSmin_8))*1
wlacznikfinal_8 = min(wlacznik_8,wlacznik_81)
CHP_Pel_8 = 35000
EnElBought_8 = max(0,[18,9]-[192,4]-PDEGSwlot_8) ! electric energy bought from net
*$UNIT_NAME Control-8
*$LAYER Main
*$POSITION 566 869

*------------------------------------------------------------------------------


* Model "1_PV-Inverter-8" (Type 194)
* 

UNIT 192 TYPE 194	 1_PV-Inverter-8
*$UNIT_NAME 1_PV-Inverter-8
*$MODEL .\Electrical\Photovoltaic Panels\With Inverter\Type194b.tmf
*$POSITION 688 869
*$LAYER Main # 
PARAMETERS 29
2		! 1 Mode
8.63		! 2 Module short-circuit current at reference conditions
37.68		! 3 Module open-circuit voltage at reference conditions
298		! 4 Reference temperature
1000		! 5 Reference insolation
30.93		! 6 Module voltage at max power point and reference conditions
8.08		! 7 Module current at max power point and reference conditions
0.07		! 8 Temperature coeficient of Isc at (ref. cond)
-0.34		! 9 Temperature coeficient of Voc (ref. cond.)
60		! 10 Number of cells wired in series
143		! 11 Number of modules in series
1		! 12 Number of modules in parallel
319		! 13 Module temperature at NOCT
293		! 14 Ambient temperature at NOCT
800		! 15 Insolation at NOCT
1.6		! 16 Module area
0.99		! 17 tau-alpha product for normal incidence
1.12		! 18 Semiconductor bandgap
1.9		! 19 Value of parameter "a" at reference conditions
5.4		! 20 Value of parameter I_L at reference conditions
0		! 21 Value of parametre I_0 at reference conditions
0.5		! 22 Module series resistance
45.81		! 23 Shunt resistance at reference conditions
0.008		! 24 Extinction coefficient-thickness product of cover
40800		! 25 Maximum inverter power
10000		! 26 Maximium inverter voltage
0		! 27 Minimum inverter voltage
0		! 28 Night tare
143		! 29 Logical unit number for inverter data
INPUTS 10
193,24 		! 1-8:Total tilted surface radiation for surface ->Total incident radiation on tilted surface
193,1 		! 1-8:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Load voltage
193,30 		! 1-8:Slope of surface ->Array slope
193,25 		! 1-8:Beam radiation for surface ->Beam radiation on tilted surface
193,26 		! 1-8:Sky diffuse radiation for surface ->Sky diffuse radiation on tilted surface
193,27 		! 1-8:Ground reflected diffuse radiation for surface ->Ground diffuse radiation on tilted surface
193,29 		! 1-8:Angle of incidence for surface ->Incidence angle on tilted surface
193,16 		! 1-8:Solar zenith angle ->Solar zenith angle
193,8 		! 1-8:Wind velocity ->Wind speed
*** INITIAL INPUT VALUES
0 0 0 0 0 0 0 0 0 0 
*** External files
ASSIGN "C:\Dysk Google\CHP model\Type194-inverter.dat" 143
*|? What file contains the inverter parameters? |1000
*------------------------------------------------------------------------------

* Model "1-8" (Type 15)
* 

UNIT 193 TYPE 15	 1-8
*$UNIT_NAME 1-8
*$MODEL .\Weather Data Reading and Processing\Standard Format\TMY2\Type15-2.tmf
*$POSITION 805 867
*$LAYER Main # 
PARAMETERS 9
2		! 1 File Type
144		! 2 Logical unit
5		! 3 Tilted Surface Radiation Mode
0.2		! 4 Ground reflectance - no snow
0.7		! 5 Ground reflectance - snow cover
1		! 6 Number of surfaces
1		! 7 Tracking mode
45		! 8 Slope of surface
0		! 9 Azimuth of surface
*** External files
ASSIGN "C:\TRNSYS17\Weather\Meteonorm\Europe\PL-Warszawa-123750.tm2" 144
*|? Which file contains the TMY-2 weather data? |1000
*------------------------------------------------------------------------------

* Model "CHP controller-9" (Type 102)
* 

UNIT 208 TYPE 102	 CHP controller-9
*$UNIT_NAME CHP controller-9
*$MODEL .\Electrical\Diesel Engine (DEGS)\DEGS Dispatch Controller\Type102a.tmf
*$POSITION 1914 2132
*$LAYER Main # 
PARAMETERS 5
1		! 1 Minimum number of DEGS in operation
1		! 2 Maximum number of DEGS in operation
250		! 3 DEGS rated power
0.4		! 4 Minimum turndown
1		! 5 Maximum power
INPUTS 1
PDEGSwlot_9		! Control-9:PDEGSwlot_9 ->Load power
*** INITIAL INPUT VALUES
500000 
*------------------------------------------------------------------------------

* EQUATIONS "Spaceheating-9"
* 
EQUATIONS 1
EnergyRateToDSH_9 = max(0,PthCHP-EnergyRateToDHW)
*$UNIT_NAME Spaceheating-9
*$LAYER Main
*$POSITION 1739 2127

*------------------------------------------------------------------------------


* Model "CHP engine-9" (Type 120)
* 

UNIT 210 TYPE 120	 CHP engine-9
*$UNIT_NAME CHP engine-9
*$MODEL .\Electrical\Diesel Engine (DEGS)\Generic Model\Type120a.tmf
*$POSITION 1914 2234
*$LAYER Main # 
*$# Generic Model DEGS
PARAMETERS 5
1		! 1 DEGS mode
5		! 2 DEGS fuel type
250		! 3 Maximum DEGS power
10		! 4 Minimum DEGS power
250		! 5 Rated power
INPUTS 3
wlacznikfinal_9		! Control-9:wlacznikfinal_9 ->DEGS on/off switch
208,1 		! CHP controller-9:Single DEG power ->DEGS power set point
208,2 		! CHP controller-9:Number of DEGS in operation ->Number of units on
*** INITIAL INPUT VALUES
1 300000 1 
*------------------------------------------------------------------------------

* EQUATIONS "Heat Production by CHP-9"
* 
EQUATIONS 4
PthCHP = GT([210,1],0)*(A*[210,1]+B*1000) 
A = 1.6668
B = 5.86345
PthCHPnom = GT(CHP_Pel_9,0)*(A*CHP_Pel_9+B*1000)    
*$UNIT_NAME Heat Production by CHP-9
*$LAYER Main
*$POSITION 1739 2233

*------------------------------------------------------------------------------


* EQUATIONS "Control-9"
* 
EQUATIONS 10
Pload1_9 = max(([18,10]-[213,4]),0)
PDEGSmin_9 = 1*0.4*CHP_Pel_9
PDEGSmax_9 = 1*1*CHP_Pel_9
PDEGS_9 = max(Pload1_9,PDEGSmin_9)
PDEGSwlot_9 = min(PDEGSmax_9,PDEGS_9)
wlacznik_9 = GT(Pload1_9,0)*1+(1-GT(Pload1_9,0))*0
wlacznik1_9 = GT(Pload1_9,PDEGSmin_9)*1 + (1-GT(Pload1_9,PDEGSmin_9))*1
wlacznikfinal_9 = min(wlacznik_9,wlacznik_91)
CHP_Pel_9 = 30000
EnElBought_9 = max(0,[18,10]-[213,4]-PDEGSwlot_9) ! electric energy bought from net
*$UNIT_NAME Control-9
*$LAYER Main
*$POSITION 565 950

*------------------------------------------------------------------------------


* Model "1_PV-Inverter-9" (Type 194)
* 

UNIT 213 TYPE 194	 1_PV-Inverter-9
*$UNIT_NAME 1_PV-Inverter-9
*$MODEL .\Electrical\Photovoltaic Panels\With Inverter\Type194b.tmf
*$POSITION 687 950
*$LAYER Main # 
PARAMETERS 29
2		! 1 Mode
8.63		! 2 Module short-circuit current at reference conditions
37.68		! 3 Module open-circuit voltage at reference conditions
298		! 4 Reference temperature
1000		! 5 Reference insolation
30.93		! 6 Module voltage at max power point and reference conditions
8.08		! 7 Module current at max power point and reference conditions
0.07		! 8 Temperature coeficient of Isc at (ref. cond)
-0.34		! 9 Temperature coeficient of Voc (ref. cond.)
60		! 10 Number of cells wired in series
132		! 11 Number of modules in series
1		! 12 Number of modules in parallel
319		! 13 Module temperature at NOCT
293		! 14 Ambient temperature at NOCT
800		! 15 Insolation at NOCT
1.6		! 16 Module area
0.99		! 17 tau-alpha product for normal incidence
1.12		! 18 Semiconductor bandgap
1.9		! 19 Value of parameter "a" at reference conditions
5.4		! 20 Value of parameter I_L at reference conditions
0		! 21 Value of parametre I_0 at reference conditions
0.5		! 22 Module series resistance
45.81		! 23 Shunt resistance at reference conditions
0.008		! 24 Extinction coefficient-thickness product of cover
40800		! 25 Maximum inverter power
10000		! 26 Maximium inverter voltage
0		! 27 Minimum inverter voltage
0		! 28 Night tare
145		! 29 Logical unit number for inverter data
INPUTS 10
214,24 		! 1-9:Total tilted surface radiation for surface ->Total incident radiation on tilted surface
214,1 		! 1-9:Dry bulb temperature ->Ambient temperature
0,0		! [unconnected] Load voltage
214,30 		! 1-9:Slope of surface ->Array slope
214,25 		! 1-9:Beam radiation for surface ->Beam radiation on tilted surface
214,26 		! 1-9:Sky diffuse radiation for surface ->Sky diffuse radiation on tilted surface
214,27 		! 1-9:Ground reflected diffuse radiation for surface ->Ground diffuse radiation on tilted surface
214,29 		! 1-9:Angle of incidence for surface ->Incidence angle on tilted surface
214,16 		! 1-9:Solar zenith angle ->Solar zenith angle
214,8 		! 1-9:Wind velocity ->Wind speed
*** INITIAL INPUT VALUES
0 0 0 0 0 0 0 0 0 0 
*** External files
ASSIGN "C:\Dysk Google\CHP model\Type194-inverter.dat" 145
*|? What file contains the inverter parameters? |1000
*------------------------------------------------------------------------------

* Model "1-9" (Type 15)
* 

UNIT 214 TYPE 15	 1-9
*$UNIT_NAME 1-9
*$MODEL .\Weather Data Reading and Processing\Standard Format\TMY2\Type15-2.tmf
*$POSITION 804 948
*$LAYER Main # 
PARAMETERS 9
2		! 1 File Type
146		! 2 Logical unit
5		! 3 Tilted Surface Radiation Mode
0.2		! 4 Ground reflectance - no snow
0.7		! 5 Ground reflectance - snow cover
1		! 6 Number of surfaces
1		! 7 Tracking mode
45		! 8 Slope of surface
0		! 9 Azimuth of surface
*** External files
ASSIGN "C:\TRNSYS17\Weather\Meteonorm\Europe\PL-Warszawa-123750.tm2" 146
*|? Which file contains the TMY-2 weather data? |1000
*------------------------------------------------------------------------------

* Model "SH_HX3-6" (Type 91)
* 

UNIT 215 TYPE 91	 SH_HX3-6
*$UNIT_NAME SH_HX3-6
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 613 4718
*$LAYER Main # 
PARAMETERS 3
0.6		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
220,1 		! TeePiece-6:Outlet temperature ->Source side inlet temperature
220,2 		! TeePiece-6:Outlet flow rate ->Source side flow rate
Tin_to_HX3_10		! SH_calc-6:Tin_to_HX3_10 ->Load side inlet temperature
FR_to_HX3_10		! SH_calc-6:FR_to_HX3_10 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* EQUATIONS "SH_calc-6"
* 
EQUATIONS 6
Tin_to_HX3_10 = 55 ! °C
FR_to_HX3_10 = (Q_sh_corr_10)/((max(1,(4.19*(abs(Tset_to_SH_10-Tin_to_HX3_10))))))*3.6 ! delta T is implicit but parameters should be 70/55°C so delta is 15°C
Tset_to_SH_10 = 70 !°C
Q_HX3_10 = [220,2]*4.19*max(0,abs(([220,1] - [215,1])))/3.6
Q_sh_corr_10 = min(Q_HX3_10,SH_Demand)
SH_HX3_rate_kW = [215,5]/3.6 !kWh/h
*$UNIT_NAME SH_calc-6
*$LAYER Main
*$POSITION 619 4840

*------------------------------------------------------------------------------


* EQUATIONS "Substation-6"
* 
EQUATIONS 4
ThotNet_10 = 90
msource_10 = [218,4]
kWhFromSubstToDHW_10 = [218,5]/3.6
kWhDryCooler_10 = [221,3]/3.6
*$UNIT_NAME Substation-6
*$LAYER Main
*$POSITION 100 4613

*------------------------------------------------------------------------------


* Model "PostHeatCHPout-6" (Type 91)
* 

UNIT 218 TYPE 91	 PostHeatCHPout-6
*$UNIT_NAME PostHeatCHPout-6
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 240 4613
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
ThotNet_10		! Substation-6:ThotNet_10 ->Source side inlet temperature
msource_10		! Substation-6:msource_10 ->Source side flow rate
228,1 		! PreheatFreshWater-6:Source-side outlet temperature ->Load side inlet temperature
228,2 		! PreheatFreshWater-6:Source side flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "Diverter-6" (Type 11)
* 

UNIT 219 TYPE 11	 Diverter-6
*$UNIT_NAME Diverter-6
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 514 4613
*$LAYER Main # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
218,3 		! PostHeatCHPout-6:Load side outlet temperature ->Inlet temperature
218,4 		! PostHeatCHPout-6:Load side flow rate ->Inlet flow rate
227,1 		! Load_Tout-6:Control signal ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 1 
*------------------------------------------------------------------------------

* Model "TeePiece-6" (Type 11)
* 

UNIT 220 TYPE 11	 TeePiece-6
*$UNIT_NAME TeePiece-6
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 682 4560
*$LAYER Main # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
226,20 		! AF3000-6:Temperature at HX Outlet ->Temperature at inlet 1
226,21 		! AF3000-6:HX flow rate ->Flow rate at inlet 1
219,3 		! Diverter-6:Temperature at outlet 2 ->Temperature at inlet 2
219,4 		! Diverter-6:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "DryCooler-6" (Type 511)
* 

UNIT 221 TYPE 511	 DryCooler-6
*$UNIT_NAME DryCooler-6
*$MODEL .\HVAC Library (TESS)\Dry Fluid Cooler\Type511.tmf
*$POSITION 208 4720
*$LAYER Main # 
*$# DRY FLUID COOLER
PARAMETERS 11
1		! 1 Heat exchanger mode
70		! 2 Design inlet fluid temperature
60		! 3 Design outlet fluid temperature
5678.12		! 4 Design fluid flow rate
4.190		! 5 Fluid specific heat
28.0		! 6 Design ambient air temperature
5678.12		! 7 Design air flow rate
5369.04		! 8 Rated fan power
10.0		! 9 Ratio of liquid h to air h
1		! 10 Number of power coefficients
1		! 11 Power coefficient
INPUTS 5
215,1 		! SH_HX3-6:Source-side outlet temperature ->Fluid inlet temperature
215,2 		! SH_HX3-6:Source side flow rate ->Fluid flow rate
0,0		! [unconnected] Ambient temperature
0,0		! [unconnected] Fan control signal
0,0		! [unconnected] Desired outlet temperature
*** INITIAL INPUT VALUES
10.0 0.0 20.0 -1 70 
*------------------------------------------------------------------------------

* EQUATIONS "DHW flow_demand-6"
* 
EQUATIONS 4
Demand_FR_10 = ((0.001*Demand_on_DHW_Pth)/(4.19*(Tload_10-Tcold_10)))*3600
Tcold_10 = 15
Tload_10 = 60
T_hotNet_10 = 90
*$UNIT_NAME DHW flow_demand-6
*$LAYER Main
*$POSITION 240 4418

*------------------------------------------------------------------------------


* EQUATIONS "Heat _from_CHP-6"
* 
EQUATIONS 2
TankTempHot_10 = max(GT(PthCHP,0)*(20+[221,1]),[221,1])
TankFR_Hot_10 = [225,2]
*$UNIT_NAME Heat _from_CHP-6
*$LAYER Main
*$POSITION 121 4307

*------------------------------------------------------------------------------


* EQUATIONS "DHW Energy rates-6"
* 
EQUATIONS 6
EnergyRatFromCHP_10 = 1000*PumpSignal*4.19*[225,2]*(TankTempHot_10-[226,20])/3600
EnergyRatToDHW_10 = 1000*([226,5]+[228,5])/3600
PumpFR_10 = max(0.7*PumpFRnom_10,(3.6*PthCHP)/(20*4.19))
PumpFRnom_10 = (3.6*PthCHPnom)/(20*4.19)
Pumpsignal_10 = min(1,PumpFR_10/PumpFRnom_10)
CHPTdelta_10 = TankTempHot_10-[226,20]
*$UNIT_NAME DHW Energy rates-6
*$LAYER Main
*$POSITION 392 4369

*------------------------------------------------------------------------------


* Model "CHP_Recirc_pump-6" (Type 110)
* 

UNIT 225 TYPE 110	 CHP_Recirc_pump-6
*$UNIT_NAME CHP_Recirc_pump-6
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 395 4267
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
2040		! 1 Rated flow rate
4.19		! 2 Fluid specific heat
2684.0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1		! 6 Power coefficient
INPUTS 5
0,0		! [unconnected] Inlet fluid temperature
0,0		! [unconnected] Inlet fluid flow rate
Pumpsignal_10		! DHW Energy rates-6:Pumpsignal_10 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
20.0 0.0 1 0.7 0.9 
*------------------------------------------------------------------------------

* Model "AF3000-6" (Type 534)
* 

UNIT 226 TYPE 534	 AF3000-6
*$UNIT_NAME AF3000-6
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\Coiled Tube HXs\Type534-Coiled.tmf
*$POSITION 509 4520
*$LAYER Main # 
*$# Cylindrical Storage Tank
PARAMETERS 60
-1		! 1 LU for data file
5		! 2 Number of tank nodes
1		! 3 Number of ports
1		! 4 Number of immersed heat exchangers
1		! 5 Number of miscellaneous heat flows
3		! 6 Tank volume
1.5		! 7 Tank height
0		! 8 Tank fluid
4.19		! 9 Fluid specific heat
1000		! 10 Fluid density
2.14		! 11 Fluid thermal conductivity
3.21		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
5.0		! 14 Top loss coefficient
5.0		! 15 Edge loss coefficient for node-1
5.0		! 16 Edge loss coefficient for node-2
5.0		! 17 Edge loss coefficient for node-3
5.0		! 18 Edge loss coefficient for node-4
5.0		! 19 Edge loss coefficient for node-5
5.0		! 20 Bottom loss coefficient
0		! 21 Additional thermal conductivity
1		! 22 Inlet flow mode
1		! 23 Entry node
1		! 24 Exit node
3.0		! 25 Flue loss coefficient for node-1
3.0		! 26 Flue loss coefficient for node-2
3.0		! 27 Flue loss coefficient for node-3
3.0		! 28 Flue loss coefficient for node-4
3.0		! 29 Flue loss coefficient for node-5
1		! 30 Node for miscellaneous heat gain
3		! 31 Type of HX
5		! 32 Number of HX nodes
0		! 33 HX fluid
4.19		! 34 HX fluid specific heat
1000		! 35 HX fluid density
2.14		! 36 HX fluid thermal conductivity
3.21		! 37 HX fluid viscosity
0.6		! 38 Multiplier for natural convection
0.25		! 39 Exponent for natural convection
1.0		! 40 Geometry factor for natural convection
1.0		! 41 Geometry exponent for natural convection
0.035		! 42 Inner tube diameter
0.036505		! 43 Outer tube diameter
2.14		! 44 HX wall thermal conductivity
83		! 45 Length of HX tubes
1		! 46 Number of tubes
0		! 47 HX header volume
0.05		! 48 HX cross sectional area
1		! 49 Coil diameter
0.05		! 50 Coil pitch
1		! 51 Tank node for HX node-1
0.2		! 52 Fraction of HX length-1
1		! 53 Tank node for HX node-2
0.2		! 54 Fraction of HX length-2
1		! 55 Tank node for HX node-3
0.2		! 56 Fraction of HX length-3
1		! 57 Tank node for HX node-4
0.2		! 58 Fraction of HX length-4
1		! 59 Tank node for HX node-5
0.2		! 60 Fraction of HX length-5
INPUTS 19
228,3 		! PreheatFreshWater-6:Load side outlet temperature ->Inlet temperature for port
228,4 		! PreheatFreshWater-6:Load side flow rate ->Inlet flow rate for port
219,1 		! Diverter-6:Temperature at outlet 1 ->Inlet temperature for HX
219,2 		! Diverter-6:Flow rate at outlet 1 ->Inlet flow rate for HX
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Edge loss temperature for node-4
0,0		! [unconnected] Edge loss temperature for node-5
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
0,0		! [unconnected] Auxiliary heat input for node-4
0,0		! [unconnected] Auxiliary heat input for node-5
0,0		! [unconnected] Miscellaneous heat input
*** INITIAL INPUT VALUES
20.0 0.0 20.0 0.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 0.0
0.0 0 
DERIVATIVES 5
20.0		! 1 Initial Tank Temperature-1
20.0		! 2 Initial Tank Temperature-2
20.0		! 3 Initial Tank Temperature-3
20.0		! 4 Initial Tank Temperature-4
20.0		! 5 Initial Tank Temperature-5
*------------------------------------------------------------------------------

* Model "Load_Tout-6" (Type 22)
* 

UNIT 227 TYPE 22	 Load_Tout-6
*$UNIT_NAME Load_Tout-6
*$MODEL .\Controllers\Iterative Feedback Controller\Type22.tmf
*$POSITION 605 4293
*$LAYER Main # 
PARAMETERS 2
0		! 1 mode
0		! 2 Maximum number of oscillations
INPUTS 7
Tload_10		! DHW flow_demand-6:Tload_10 ->Setpoint
226,1 		! AF3000-6:Temperature at outlet ->Controlled variable
0,0		! [unconnected] On / Off signal
0,0		! [unconnected] Minimum control signal
0,0		! [unconnected] Maximum control signal
0,0		! [unconnected] Threshold for non-zero output
0,0		! [unconnected] Tolerance on tracking error
*** INITIAL INPUT VALUES
58 0 1 0 1 0 0 
*------------------------------------------------------------------------------

* Model "PreheatFreshWater-6" (Type 91)
* 

UNIT 228 TYPE 91	 PreheatFreshWater-6
*$UNIT_NAME PreheatFreshWater-6
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 240 4520
*$LAYER Main # 
PARAMETERS 3
0		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
TankTempHot_10		! Heat _from_CHP-6:TankTempHot_10 ->Source side inlet temperature
TankFR_Hot_10		! Heat _from_CHP-6:TankFR_Hot_10 ->Source side flow rate
Tcold_10		! DHW flow_demand-6:Tcold_10 ->Load side inlet temperature
Demand_FR_10		! DHW flow_demand-6:Demand_FR_10 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "SH_HX3-7" (Type 91)
* 

UNIT 229 TYPE 91	 SH_HX3-7
*$UNIT_NAME SH_HX3-7
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 665 5276
*$LAYER Main # 
PARAMETERS 3
0.6		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
234,1 		! TeePiece-7:Outlet temperature ->Source side inlet temperature
234,2 		! TeePiece-7:Outlet flow rate ->Source side flow rate
Tin_to_HX3_10		! SH_calc-7:Tin_to_HX3_10 ->Load side inlet temperature
FR_to_HX3_10		! SH_calc-7:FR_to_HX3_10 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* EQUATIONS "SH_calc-7"
* 
EQUATIONS 6
Tin_to_HX3_10 = 55 ! °C
FR_to_HX3_10 = (Q_sh_corr_10)/((max(1,(4.19*(abs(Tset_to_SH_10-Tin_to_HX3_10))))))*3.6 ! delta T is implicit but parameters should be 70/55°C so delta is 15°C
Tset_to_SH_10 = 70 !°C
Q_HX3_10 = [234,2]*4.19*max(0,abs(([234,1] - [229,1])))/3.6
Q_sh_corr_10 = min(Q_HX3_10,SH_Demand)
SH_HX3_rate_kW = [229,5]/3.6 !kWh/h
*$UNIT_NAME SH_calc-7
*$LAYER Main
*$POSITION 671 5398

*------------------------------------------------------------------------------


* EQUATIONS "Substation-7"
* 
EQUATIONS 4
ThotNet_10 = 90
msource_10 = [232,4]
kWhFromSubstToDHW_10 = [232,5]/3.6
kWhDryCooler_10 = [235,3]/3.6
*$UNIT_NAME Substation-7
*$LAYER Main
*$POSITION 152 5171

*------------------------------------------------------------------------------


* Model "PostHeatCHPout-7" (Type 91)
* 

UNIT 232 TYPE 91	 PostHeatCHPout-7
*$UNIT_NAME PostHeatCHPout-7
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 292 5171
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
ThotNet_10		! Substation-7:ThotNet_10 ->Source side inlet temperature
msource_10		! Substation-7:msource_10 ->Source side flow rate
242,1 		! PreheatFreshWater-7:Source-side outlet temperature ->Load side inlet temperature
242,2 		! PreheatFreshWater-7:Source side flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "Diverter-7" (Type 11)
* 

UNIT 233 TYPE 11	 Diverter-7
*$UNIT_NAME Diverter-7
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 566 5171
*$LAYER Main # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
232,3 		! PostHeatCHPout-7:Load side outlet temperature ->Inlet temperature
232,4 		! PostHeatCHPout-7:Load side flow rate ->Inlet flow rate
241,1 		! Load_Tout-7:Control signal ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 1 
*------------------------------------------------------------------------------

* Model "TeePiece-7" (Type 11)
* 

UNIT 234 TYPE 11	 TeePiece-7
*$UNIT_NAME TeePiece-7
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 734 5118
*$LAYER Main # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
240,20 		! AF3000-7:Temperature at HX Outlet ->Temperature at inlet 1
240,21 		! AF3000-7:HX flow rate ->Flow rate at inlet 1
233,3 		! Diverter-7:Temperature at outlet 2 ->Temperature at inlet 2
233,4 		! Diverter-7:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "DryCooler-7" (Type 511)
* 

UNIT 235 TYPE 511	 DryCooler-7
*$UNIT_NAME DryCooler-7
*$MODEL .\HVAC Library (TESS)\Dry Fluid Cooler\Type511.tmf
*$POSITION 260 5278
*$LAYER Main # 
*$# DRY FLUID COOLER
PARAMETERS 11
1		! 1 Heat exchanger mode
70		! 2 Design inlet fluid temperature
60		! 3 Design outlet fluid temperature
5678.12		! 4 Design fluid flow rate
4.190		! 5 Fluid specific heat
28.0		! 6 Design ambient air temperature
5678.12		! 7 Design air flow rate
5369.04		! 8 Rated fan power
10.0		! 9 Ratio of liquid h to air h
1		! 10 Number of power coefficients
1		! 11 Power coefficient
INPUTS 5
229,1 		! SH_HX3-7:Source-side outlet temperature ->Fluid inlet temperature
229,2 		! SH_HX3-7:Source side flow rate ->Fluid flow rate
0,0		! [unconnected] Ambient temperature
0,0		! [unconnected] Fan control signal
0,0		! [unconnected] Desired outlet temperature
*** INITIAL INPUT VALUES
10.0 0.0 20.0 -1 70 
*------------------------------------------------------------------------------

* EQUATIONS "DHW flow_demand-7"
* 
EQUATIONS 4
Demand_FR_10 = ((0.001*Demand_on_DHW_Pth)/(4.19*(Tload_10-Tcold_10)))*3600
Tcold_10 = 15
Tload_10 = 60
T_hotNet_10 = 90
*$UNIT_NAME DHW flow_demand-7
*$LAYER Main
*$POSITION 292 4976

*------------------------------------------------------------------------------


* EQUATIONS "Heat _from_CHP-7"
* 
EQUATIONS 2
TankTempHot_10 = max(GT(PthCHP,0)*(20+[235,1]),[235,1])
TankFR_Hot_10 = [239,2]
*$UNIT_NAME Heat _from_CHP-7
*$LAYER Main
*$POSITION 173 4865

*------------------------------------------------------------------------------


* EQUATIONS "DHW Energy rates-7"
* 
EQUATIONS 6
EnergyRatFromCHP_10 = 1000*PumpSignal*4.19*[239,2]*(TankTempHot_10-[240,20])/3600
EnergyRatToDHW_10 = 1000*([240,5]+[242,5])/3600
PumpFR_10 = max(0.7*PumpFRnom_10,(3.6*PthCHP)/(20*4.19))
PumpFRnom_10 = (3.6*PthCHPnom)/(20*4.19)
Pumpsignal_10 = min(1,PumpFR_10/PumpFRnom_10)
CHPTdelta_10 = TankTempHot_10-[240,20]
*$UNIT_NAME DHW Energy rates-7
*$LAYER Main
*$POSITION 444 4927

*------------------------------------------------------------------------------


* Model "CHP_Recirc_pump-7" (Type 110)
* 

UNIT 239 TYPE 110	 CHP_Recirc_pump-7
*$UNIT_NAME CHP_Recirc_pump-7
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 447 4825
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
2040		! 1 Rated flow rate
4.19		! 2 Fluid specific heat
2684.0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1		! 6 Power coefficient
INPUTS 5
0,0		! [unconnected] Inlet fluid temperature
0,0		! [unconnected] Inlet fluid flow rate
Pumpsignal_10		! DHW Energy rates-7:Pumpsignal_10 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
20.0 0.0 1 0.7 0.9 
*------------------------------------------------------------------------------

* Model "AF3000-7" (Type 534)
* 

UNIT 240 TYPE 534	 AF3000-7
*$UNIT_NAME AF3000-7
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\Coiled Tube HXs\Type534-Coiled.tmf
*$POSITION 561 5078
*$LAYER Main # 
*$# Cylindrical Storage Tank
PARAMETERS 60
-1		! 1 LU for data file
5		! 2 Number of tank nodes
1		! 3 Number of ports
1		! 4 Number of immersed heat exchangers
1		! 5 Number of miscellaneous heat flows
3		! 6 Tank volume
1.5		! 7 Tank height
0		! 8 Tank fluid
4.19		! 9 Fluid specific heat
1000		! 10 Fluid density
2.14		! 11 Fluid thermal conductivity
3.21		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
5.0		! 14 Top loss coefficient
5.0		! 15 Edge loss coefficient for node-1
5.0		! 16 Edge loss coefficient for node-2
5.0		! 17 Edge loss coefficient for node-3
5.0		! 18 Edge loss coefficient for node-4
5.0		! 19 Edge loss coefficient for node-5
5.0		! 20 Bottom loss coefficient
0		! 21 Additional thermal conductivity
1		! 22 Inlet flow mode
1		! 23 Entry node
1		! 24 Exit node
3.0		! 25 Flue loss coefficient for node-1
3.0		! 26 Flue loss coefficient for node-2
3.0		! 27 Flue loss coefficient for node-3
3.0		! 28 Flue loss coefficient for node-4
3.0		! 29 Flue loss coefficient for node-5
1		! 30 Node for miscellaneous heat gain
3		! 31 Type of HX
5		! 32 Number of HX nodes
0		! 33 HX fluid
4.19		! 34 HX fluid specific heat
1000		! 35 HX fluid density
2.14		! 36 HX fluid thermal conductivity
3.21		! 37 HX fluid viscosity
0.6		! 38 Multiplier for natural convection
0.25		! 39 Exponent for natural convection
1.0		! 40 Geometry factor for natural convection
1.0		! 41 Geometry exponent for natural convection
0.035		! 42 Inner tube diameter
0.036505		! 43 Outer tube diameter
2.14		! 44 HX wall thermal conductivity
83		! 45 Length of HX tubes
1		! 46 Number of tubes
0		! 47 HX header volume
0.05		! 48 HX cross sectional area
1		! 49 Coil diameter
0.05		! 50 Coil pitch
1		! 51 Tank node for HX node-1
0.2		! 52 Fraction of HX length-1
1		! 53 Tank node for HX node-2
0.2		! 54 Fraction of HX length-2
1		! 55 Tank node for HX node-3
0.2		! 56 Fraction of HX length-3
1		! 57 Tank node for HX node-4
0.2		! 58 Fraction of HX length-4
1		! 59 Tank node for HX node-5
0.2		! 60 Fraction of HX length-5
INPUTS 19
242,3 		! PreheatFreshWater-7:Load side outlet temperature ->Inlet temperature for port
242,4 		! PreheatFreshWater-7:Load side flow rate ->Inlet flow rate for port
233,1 		! Diverter-7:Temperature at outlet 1 ->Inlet temperature for HX
233,2 		! Diverter-7:Flow rate at outlet 1 ->Inlet flow rate for HX
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Edge loss temperature for node-4
0,0		! [unconnected] Edge loss temperature for node-5
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
0,0		! [unconnected] Auxiliary heat input for node-4
0,0		! [unconnected] Auxiliary heat input for node-5
0,0		! [unconnected] Miscellaneous heat input
*** INITIAL INPUT VALUES
20.0 0.0 20.0 0.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 0.0
0.0 0 
DERIVATIVES 5
20.0		! 1 Initial Tank Temperature-1
20.0		! 2 Initial Tank Temperature-2
20.0		! 3 Initial Tank Temperature-3
20.0		! 4 Initial Tank Temperature-4
20.0		! 5 Initial Tank Temperature-5
*------------------------------------------------------------------------------

* Model "Load_Tout-7" (Type 22)
* 

UNIT 241 TYPE 22	 Load_Tout-7
*$UNIT_NAME Load_Tout-7
*$MODEL .\Controllers\Iterative Feedback Controller\Type22.tmf
*$POSITION 657 4851
*$LAYER Main # 
PARAMETERS 2
0		! 1 mode
0		! 2 Maximum number of oscillations
INPUTS 7
Tload_10		! DHW flow_demand-7:Tload_10 ->Setpoint
240,1 		! AF3000-7:Temperature at outlet ->Controlled variable
0,0		! [unconnected] On / Off signal
0,0		! [unconnected] Minimum control signal
0,0		! [unconnected] Maximum control signal
0,0		! [unconnected] Threshold for non-zero output
0,0		! [unconnected] Tolerance on tracking error
*** INITIAL INPUT VALUES
58 0 1 0 1 0 0 
*------------------------------------------------------------------------------

* Model "PreheatFreshWater-7" (Type 91)
* 

UNIT 242 TYPE 91	 PreheatFreshWater-7
*$UNIT_NAME PreheatFreshWater-7
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 292 5078
*$LAYER Main # 
PARAMETERS 3
0		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
TankTempHot_10		! Heat _from_CHP-7:TankTempHot_10 ->Source side inlet temperature
TankFR_Hot_10		! Heat _from_CHP-7:TankFR_Hot_10 ->Source side flow rate
Tcold_10		! DHW flow_demand-7:Tcold_10 ->Load side inlet temperature
Demand_FR_10		! DHW flow_demand-7:Demand_FR_10 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "SH_HX3-8" (Type 91)
* 

UNIT 184 TYPE 91	 SH_HX3-8
*$UNIT_NAME SH_HX3-8
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 626 6140
*$LAYER Main # 
PARAMETERS 3
0.6		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
245,1 		! TeePiece-8:Outlet temperature ->Source side inlet temperature
245,2 		! TeePiece-8:Outlet flow rate ->Source side flow rate
Tin_to_HX3_10		! SH_calc-8:Tin_to_HX3_10 ->Load side inlet temperature
FR_to_HX3_10		! SH_calc-8:FR_to_HX3_10 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* EQUATIONS "SH_calc-8"
* 
EQUATIONS 6
Tin_to_HX3_10 = 55 ! °C
FR_to_HX3_10 = (Q_sh_corr_10)/((max(1,(4.19*(abs(Tset_to_SH_10-Tin_to_HX3_10))))))*3.6 ! delta T is implicit but parameters should be 70/55°C so delta is 15°C
Tset_to_SH_10 = 70 !°C
Q_HX3_10 = [245,2]*4.19*max(0,abs(([245,1] - [184,1])))/3.6
Q_sh_corr_10 = min(Q_HX3_10,SH_Demand)
SH_HX3_rate_kW = [184,5]/3.6 !kWh/h
*$UNIT_NAME SH_calc-8
*$LAYER Main
*$POSITION 632 6262

*------------------------------------------------------------------------------


* EQUATIONS "Substation-8"
* 
EQUATIONS 4
ThotNet_10 = 90
msource_10 = [243,4]
kWhFromSubstToDHW_10 = [243,5]/3.6
kWhDryCooler_10 = [246,3]/3.6
*$UNIT_NAME Substation-8
*$LAYER Main
*$POSITION 113 6035

*------------------------------------------------------------------------------


* Model "PostHeatCHPout-8" (Type 91)
* 

UNIT 243 TYPE 91	 PostHeatCHPout-8
*$UNIT_NAME PostHeatCHPout-8
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 253 6035
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
ThotNet_10		! Substation-8:ThotNet_10 ->Source side inlet temperature
msource_10		! Substation-8:msource_10 ->Source side flow rate
253,1 		! PreheatFreshWater-8:Source-side outlet temperature ->Load side inlet temperature
253,2 		! PreheatFreshWater-8:Source side flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "Diverter-8" (Type 11)
* 

UNIT 244 TYPE 11	 Diverter-8
*$UNIT_NAME Diverter-8
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 527 6035
*$LAYER Main # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
243,3 		! PostHeatCHPout-8:Load side outlet temperature ->Inlet temperature
243,4 		! PostHeatCHPout-8:Load side flow rate ->Inlet flow rate
252,1 		! Load_Tout-8:Control signal ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 1 
*------------------------------------------------------------------------------

* Model "TeePiece-8" (Type 11)
* 

UNIT 245 TYPE 11	 TeePiece-8
*$UNIT_NAME TeePiece-8
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 695 5982
*$LAYER Main # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
251,20 		! AF3000-8:Temperature at HX Outlet ->Temperature at inlet 1
251,21 		! AF3000-8:HX flow rate ->Flow rate at inlet 1
244,3 		! Diverter-8:Temperature at outlet 2 ->Temperature at inlet 2
244,4 		! Diverter-8:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "DryCooler-8" (Type 511)
* 

UNIT 246 TYPE 511	 DryCooler-8
*$UNIT_NAME DryCooler-8
*$MODEL .\HVAC Library (TESS)\Dry Fluid Cooler\Type511.tmf
*$POSITION 221 6142
*$LAYER Main # 
*$# DRY FLUID COOLER
PARAMETERS 11
1		! 1 Heat exchanger mode
70		! 2 Design inlet fluid temperature
60		! 3 Design outlet fluid temperature
5678.12		! 4 Design fluid flow rate
4.190		! 5 Fluid specific heat
28.0		! 6 Design ambient air temperature
5678.12		! 7 Design air flow rate
5369.04		! 8 Rated fan power
10.0		! 9 Ratio of liquid h to air h
1		! 10 Number of power coefficients
1		! 11 Power coefficient
INPUTS 5
184,1 		! SH_HX3-8:Source-side outlet temperature ->Fluid inlet temperature
184,2 		! SH_HX3-8:Source side flow rate ->Fluid flow rate
0,0		! [unconnected] Ambient temperature
0,0		! [unconnected] Fan control signal
0,0		! [unconnected] Desired outlet temperature
*** INITIAL INPUT VALUES
10.0 0.0 20.0 -1 70 
*------------------------------------------------------------------------------

* EQUATIONS "DHW flow_demand-8"
* 
EQUATIONS 4
Demand_FR_10 = ((0.001*Demand_on_DHW_Pth)/(4.19*(Tload_10-Tcold_10)))*3600
Tcold_10 = 15
Tload_10 = 60
T_hotNet_10 = 90
*$UNIT_NAME DHW flow_demand-8
*$LAYER Main
*$POSITION 253 5840

*------------------------------------------------------------------------------


* EQUATIONS "Heat _from_CHP-8"
* 
EQUATIONS 2
TankTempHot_10 = max(GT(PthCHP,0)*(20+[246,1]),[246,1])
TankFR_Hot_10 = [250,2]
*$UNIT_NAME Heat _from_CHP-8
*$LAYER Main
*$POSITION 134 5729

*------------------------------------------------------------------------------


* EQUATIONS "DHW Energy rates-8"
* 
EQUATIONS 6
EnergyRatFromCHP_10 = 1000*PumpSignal*4.19*[250,2]*(TankTempHot_10-[251,20])/3600
EnergyRatToDHW_10 = 1000*([251,5]+[253,5])/3600
PumpFR_10 = max(0.7*PumpFRnom_10,(3.6*PthCHP)/(20*4.19))
PumpFRnom_10 = (3.6*PthCHPnom)/(20*4.19)
Pumpsignal_10 = min(1,PumpFR_10/PumpFRnom_10)
CHPTdelta_10 = TankTempHot_10-[251,20]
*$UNIT_NAME DHW Energy rates-8
*$LAYER Main
*$POSITION 405 5791

*------------------------------------------------------------------------------


* Model "CHP_Recirc_pump-8" (Type 110)
* 

UNIT 250 TYPE 110	 CHP_Recirc_pump-8
*$UNIT_NAME CHP_Recirc_pump-8
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 408 5689
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
2040		! 1 Rated flow rate
4.19		! 2 Fluid specific heat
2684.0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1		! 6 Power coefficient
INPUTS 5
0,0		! [unconnected] Inlet fluid temperature
0,0		! [unconnected] Inlet fluid flow rate
Pumpsignal_10		! DHW Energy rates-8:Pumpsignal_10 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
20.0 0.0 1 0.7 0.9 
*------------------------------------------------------------------------------

* Model "AF3000-8" (Type 534)
* 

UNIT 251 TYPE 534	 AF3000-8
*$UNIT_NAME AF3000-8
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\Coiled Tube HXs\Type534-Coiled.tmf
*$POSITION 522 5942
*$LAYER Main # 
*$# Cylindrical Storage Tank
PARAMETERS 60
-1		! 1 LU for data file
5		! 2 Number of tank nodes
1		! 3 Number of ports
1		! 4 Number of immersed heat exchangers
1		! 5 Number of miscellaneous heat flows
3		! 6 Tank volume
1.5		! 7 Tank height
0		! 8 Tank fluid
4.19		! 9 Fluid specific heat
1000		! 10 Fluid density
2.14		! 11 Fluid thermal conductivity
3.21		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
5.0		! 14 Top loss coefficient
5.0		! 15 Edge loss coefficient for node-1
5.0		! 16 Edge loss coefficient for node-2
5.0		! 17 Edge loss coefficient for node-3
5.0		! 18 Edge loss coefficient for node-4
5.0		! 19 Edge loss coefficient for node-5
5.0		! 20 Bottom loss coefficient
0		! 21 Additional thermal conductivity
1		! 22 Inlet flow mode
1		! 23 Entry node
1		! 24 Exit node
3.0		! 25 Flue loss coefficient for node-1
3.0		! 26 Flue loss coefficient for node-2
3.0		! 27 Flue loss coefficient for node-3
3.0		! 28 Flue loss coefficient for node-4
3.0		! 29 Flue loss coefficient for node-5
1		! 30 Node for miscellaneous heat gain
3		! 31 Type of HX
5		! 32 Number of HX nodes
0		! 33 HX fluid
4.19		! 34 HX fluid specific heat
1000		! 35 HX fluid density
2.14		! 36 HX fluid thermal conductivity
3.21		! 37 HX fluid viscosity
0.6		! 38 Multiplier for natural convection
0.25		! 39 Exponent for natural convection
1.0		! 40 Geometry factor for natural convection
1.0		! 41 Geometry exponent for natural convection
0.035		! 42 Inner tube diameter
0.036505		! 43 Outer tube diameter
2.14		! 44 HX wall thermal conductivity
83		! 45 Length of HX tubes
1		! 46 Number of tubes
0		! 47 HX header volume
0.05		! 48 HX cross sectional area
1		! 49 Coil diameter
0.05		! 50 Coil pitch
1		! 51 Tank node for HX node-1
0.2		! 52 Fraction of HX length-1
1		! 53 Tank node for HX node-2
0.2		! 54 Fraction of HX length-2
1		! 55 Tank node for HX node-3
0.2		! 56 Fraction of HX length-3
1		! 57 Tank node for HX node-4
0.2		! 58 Fraction of HX length-4
1		! 59 Tank node for HX node-5
0.2		! 60 Fraction of HX length-5
INPUTS 19
253,3 		! PreheatFreshWater-8:Load side outlet temperature ->Inlet temperature for port
253,4 		! PreheatFreshWater-8:Load side flow rate ->Inlet flow rate for port
244,1 		! Diverter-8:Temperature at outlet 1 ->Inlet temperature for HX
244,2 		! Diverter-8:Flow rate at outlet 1 ->Inlet flow rate for HX
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Edge loss temperature for node-4
0,0		! [unconnected] Edge loss temperature for node-5
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
0,0		! [unconnected] Auxiliary heat input for node-4
0,0		! [unconnected] Auxiliary heat input for node-5
0,0		! [unconnected] Miscellaneous heat input
*** INITIAL INPUT VALUES
20.0 0.0 20.0 0.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 0.0
0.0 0 
DERIVATIVES 5
20.0		! 1 Initial Tank Temperature-1
20.0		! 2 Initial Tank Temperature-2
20.0		! 3 Initial Tank Temperature-3
20.0		! 4 Initial Tank Temperature-4
20.0		! 5 Initial Tank Temperature-5
*------------------------------------------------------------------------------

* Model "Load_Tout-8" (Type 22)
* 

UNIT 252 TYPE 22	 Load_Tout-8
*$UNIT_NAME Load_Tout-8
*$MODEL .\Controllers\Iterative Feedback Controller\Type22.tmf
*$POSITION 618 5715
*$LAYER Main # 
PARAMETERS 2
0		! 1 mode
0		! 2 Maximum number of oscillations
INPUTS 7
Tload_10		! DHW flow_demand-8:Tload_10 ->Setpoint
251,1 		! AF3000-8:Temperature at outlet ->Controlled variable
0,0		! [unconnected] On / Off signal
0,0		! [unconnected] Minimum control signal
0,0		! [unconnected] Maximum control signal
0,0		! [unconnected] Threshold for non-zero output
0,0		! [unconnected] Tolerance on tracking error
*** INITIAL INPUT VALUES
58 0 1 0 1 0 0 
*------------------------------------------------------------------------------

* Model "PreheatFreshWater-8" (Type 91)
* 

UNIT 253 TYPE 91	 PreheatFreshWater-8
*$UNIT_NAME PreheatFreshWater-8
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 253 5942
*$LAYER Main # 
PARAMETERS 3
0		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
TankTempHot_10		! Heat _from_CHP-8:TankTempHot_10 ->Source side inlet temperature
TankFR_Hot_10		! Heat _from_CHP-8:TankFR_Hot_10 ->Source side flow rate
Tcold_10		! DHW flow_demand-8:Tcold_10 ->Load side inlet temperature
Demand_FR_10		! DHW flow_demand-8:Demand_FR_10 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "SH_HX3-9" (Type 91)
* 

UNIT 194 TYPE 91	 SH_HX3-9
*$UNIT_NAME SH_HX3-9
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 643 7843
*$LAYER Main # 
PARAMETERS 3
0.6		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
199,1 		! TeePiece-9:Outlet temperature ->Source side inlet temperature
199,2 		! TeePiece-9:Outlet flow rate ->Source side flow rate
Tin_to_HX3_10		! SH_calc-9:Tin_to_HX3_10 ->Load side inlet temperature
FR_to_HX3_10		! SH_calc-9:FR_to_HX3_10 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* EQUATIONS "SH_calc-9"
* 
EQUATIONS 6
Tin_to_HX3_10 = 55 ! °C
FR_to_HX3_10 = (Q_sh_corr_10)/((max(1,(4.19*(abs(Tset_to_SH_10-Tin_to_HX3_10))))))*3.6 ! delta T is implicit but parameters should be 70/55°C so delta is 15°C
Tset_to_SH_10 = 70 !°C
Q_HX3_10 = [199,2]*4.19*max(0,abs(([199,1] - [194,1])))/3.6
Q_sh_corr_10 = min(Q_HX3_10,SH_Demand)
SH_HX3_rate_kW = [194,5]/3.6 !kWh/h
*$UNIT_NAME SH_calc-9
*$LAYER Main
*$POSITION 649 7965

*------------------------------------------------------------------------------


* EQUATIONS "Substation-9"
* 
EQUATIONS 4
ThotNet_10 = 90
msource_10 = [197,4]
kWhFromSubstToDHW_10 = [197,5]/3.6
kWhDryCooler_10 = [200,3]/3.6
*$UNIT_NAME Substation-9
*$LAYER Main
*$POSITION 130 7738

*------------------------------------------------------------------------------


* Model "PostHeatCHPout-9" (Type 91)
* 

UNIT 197 TYPE 91	 PostHeatCHPout-9
*$UNIT_NAME PostHeatCHPout-9
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 270 7738
*$LAYER Main # 
PARAMETERS 3
1		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
ThotNet_10		! Substation-9:ThotNet_10 ->Source side inlet temperature
msource_10		! Substation-9:msource_10 ->Source side flow rate
207,1 		! PreheatFreshWater-9:Source-side outlet temperature ->Load side inlet temperature
207,2 		! PreheatFreshWater-9:Source side flow rate ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "Diverter-9" (Type 11)
* 

UNIT 198 TYPE 11	 Diverter-9
*$UNIT_NAME Diverter-9
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 544 7738
*$LAYER Main # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
197,3 		! PostHeatCHPout-9:Load side outlet temperature ->Inlet temperature
197,4 		! PostHeatCHPout-9:Load side flow rate ->Inlet flow rate
206,1 		! Load_Tout-9:Control signal ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 1 
*------------------------------------------------------------------------------

* Model "TeePiece-9" (Type 11)
* 

UNIT 199 TYPE 11	 TeePiece-9
*$UNIT_NAME TeePiece-9
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 712 7685
*$LAYER Main # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
205,20 		! AF3000-9:Temperature at HX Outlet ->Temperature at inlet 1
205,21 		! AF3000-9:HX flow rate ->Flow rate at inlet 1
198,3 		! Diverter-9:Temperature at outlet 2 ->Temperature at inlet 2
198,4 		! Diverter-9:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

* Model "DryCooler-9" (Type 511)
* 

UNIT 200 TYPE 511	 DryCooler-9
*$UNIT_NAME DryCooler-9
*$MODEL .\HVAC Library (TESS)\Dry Fluid Cooler\Type511.tmf
*$POSITION 238 7845
*$LAYER Main # 
*$# DRY FLUID COOLER
PARAMETERS 11
1		! 1 Heat exchanger mode
70		! 2 Design inlet fluid temperature
60		! 3 Design outlet fluid temperature
5678.12		! 4 Design fluid flow rate
4.190		! 5 Fluid specific heat
28.0		! 6 Design ambient air temperature
5678.12		! 7 Design air flow rate
5369.04		! 8 Rated fan power
10.0		! 9 Ratio of liquid h to air h
1		! 10 Number of power coefficients
1		! 11 Power coefficient
INPUTS 5
194,1 		! SH_HX3-9:Source-side outlet temperature ->Fluid inlet temperature
194,2 		! SH_HX3-9:Source side flow rate ->Fluid flow rate
0,0		! [unconnected] Ambient temperature
0,0		! [unconnected] Fan control signal
0,0		! [unconnected] Desired outlet temperature
*** INITIAL INPUT VALUES
10.0 0.0 20.0 -1 70 
*------------------------------------------------------------------------------

* EQUATIONS "DHW flow_demand-9"
* 
EQUATIONS 4
Demand_FR_10 = ((0.001*Demand_on_DHW_Pth)/(4.19*(Tload_10-Tcold_10)))*3600
Tcold_10 = 15
Tload_10 = 60
T_hotNet_10 = 90
*$UNIT_NAME DHW flow_demand-9
*$LAYER Main
*$POSITION 270 7543

*------------------------------------------------------------------------------


* EQUATIONS "Heat _from_CHP-9"
* 
EQUATIONS 2
TankTempHot_10 = max(GT(PthCHP,0)*(20+[200,1]),[200,1])
TankFR_Hot_10 = [204,2]
*$UNIT_NAME Heat _from_CHP-9
*$LAYER Main
*$POSITION 151 7432

*------------------------------------------------------------------------------


* EQUATIONS "DHW Energy rates-9"
* 
EQUATIONS 6
EnergyRatFromCHP_10 = 1000*PumpSignal*4.19*[204,2]*(TankTempHot_10-[205,20])/3600
EnergyRatToDHW_10 = 1000*([205,5]+[207,5])/3600
PumpFR_10 = max(0.7*PumpFRnom_10,(3.6*PthCHP)/(20*4.19))
PumpFRnom_10 = (3.6*PthCHPnom)/(20*4.19)
Pumpsignal_10 = min(1,PumpFR_10/PumpFRnom_10)
CHPTdelta_10 = TankTempHot_10-[205,20]
*$UNIT_NAME DHW Energy rates-9
*$LAYER Main
*$POSITION 422 7494

*------------------------------------------------------------------------------


* Model "CHP_Recirc_pump-9" (Type 110)
* 

UNIT 204 TYPE 110	 CHP_Recirc_pump-9
*$UNIT_NAME CHP_Recirc_pump-9
*$MODEL .\Hydronics\Pumps\Variable Speed\Type110.tmf
*$POSITION 425 7392
*$LAYER Main # 
*$# VARIABLE-SPEED PUMP
PARAMETERS 6
2040		! 1 Rated flow rate
4.19		! 2 Fluid specific heat
2684.0		! 3 Rated power
0.0		! 4 Motor heat loss fraction
1		! 5 Number of power coefficients
1		! 6 Power coefficient
INPUTS 5
0,0		! [unconnected] Inlet fluid temperature
0,0		! [unconnected] Inlet fluid flow rate
Pumpsignal_10		! DHW Energy rates-9:Pumpsignal_10 ->Control signal
0,0		! [unconnected] Total pump efficiency
0,0		! [unconnected] Motor efficiency
*** INITIAL INPUT VALUES
20.0 0.0 1 0.7 0.9 
*------------------------------------------------------------------------------

* Model "AF3000-9" (Type 534)
* 

UNIT 205 TYPE 534	 AF3000-9
*$UNIT_NAME AF3000-9
*$MODEL .\Storage Tank Library (TESS)\Cylindrical Storage Tank\Vertical Cylinder\Version without Plug-In\Coiled Tube HXs\Type534-Coiled.tmf
*$POSITION 539 7645
*$LAYER Main # 
*$# Cylindrical Storage Tank
PARAMETERS 60
-1		! 1 LU for data file
5		! 2 Number of tank nodes
1		! 3 Number of ports
1		! 4 Number of immersed heat exchangers
1		! 5 Number of miscellaneous heat flows
3		! 6 Tank volume
1.5		! 7 Tank height
0		! 8 Tank fluid
4.19		! 9 Fluid specific heat
1000		! 10 Fluid density
2.14		! 11 Fluid thermal conductivity
3.21		! 12 Fluid viscosity
0.00026		! 13 Fluid thermal expansion coefficient
5.0		! 14 Top loss coefficient
5.0		! 15 Edge loss coefficient for node-1
5.0		! 16 Edge loss coefficient for node-2
5.0		! 17 Edge loss coefficient for node-3
5.0		! 18 Edge loss coefficient for node-4
5.0		! 19 Edge loss coefficient for node-5
5.0		! 20 Bottom loss coefficient
0		! 21 Additional thermal conductivity
1		! 22 Inlet flow mode
1		! 23 Entry node
1		! 24 Exit node
3.0		! 25 Flue loss coefficient for node-1
3.0		! 26 Flue loss coefficient for node-2
3.0		! 27 Flue loss coefficient for node-3
3.0		! 28 Flue loss coefficient for node-4
3.0		! 29 Flue loss coefficient for node-5
1		! 30 Node for miscellaneous heat gain
3		! 31 Type of HX
5		! 32 Number of HX nodes
0		! 33 HX fluid
4.19		! 34 HX fluid specific heat
1000		! 35 HX fluid density
2.14		! 36 HX fluid thermal conductivity
3.21		! 37 HX fluid viscosity
0.6		! 38 Multiplier for natural convection
0.25		! 39 Exponent for natural convection
1.0		! 40 Geometry factor for natural convection
1.0		! 41 Geometry exponent for natural convection
0.035		! 42 Inner tube diameter
0.036505		! 43 Outer tube diameter
2.14		! 44 HX wall thermal conductivity
83		! 45 Length of HX tubes
1		! 46 Number of tubes
0		! 47 HX header volume
0.05		! 48 HX cross sectional area
1		! 49 Coil diameter
0.05		! 50 Coil pitch
1		! 51 Tank node for HX node-1
0.2		! 52 Fraction of HX length-1
1		! 53 Tank node for HX node-2
0.2		! 54 Fraction of HX length-2
1		! 55 Tank node for HX node-3
0.2		! 56 Fraction of HX length-3
1		! 57 Tank node for HX node-4
0.2		! 58 Fraction of HX length-4
1		! 59 Tank node for HX node-5
0.2		! 60 Fraction of HX length-5
INPUTS 19
207,3 		! PreheatFreshWater-9:Load side outlet temperature ->Inlet temperature for port
207,4 		! PreheatFreshWater-9:Load side flow rate ->Inlet flow rate for port
198,1 		! Diverter-9:Temperature at outlet 1 ->Inlet temperature for HX
198,2 		! Diverter-9:Flow rate at outlet 1 ->Inlet flow rate for HX
0,0		! [unconnected] Top loss temperature
0,0		! [unconnected] Edge loss temperature for node-1
0,0		! [unconnected] Edge loss temperature for node-2
0,0		! [unconnected] Edge loss temperature for node-3
0,0		! [unconnected] Edge loss temperature for node-4
0,0		! [unconnected] Edge loss temperature for node-5
0,0		! [unconnected] Bottom loss temperature
0,0		! [unconnected] Gas flue temperature
0,0		! [unconnected] Inversion mixing flow rate
0,0		! [unconnected] Auxiliary heat input for node-1
0,0		! [unconnected] Auxiliary heat input for node-2
0,0		! [unconnected] Auxiliary heat input for node-3
0,0		! [unconnected] Auxiliary heat input for node-4
0,0		! [unconnected] Auxiliary heat input for node-5
0,0		! [unconnected] Miscellaneous heat input
*** INITIAL INPUT VALUES
20.0 0.0 20.0 0.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 20.0 -100 0.0 0.0 0.0 0.0
0.0 0 
DERIVATIVES 5
20.0		! 1 Initial Tank Temperature-1
20.0		! 2 Initial Tank Temperature-2
20.0		! 3 Initial Tank Temperature-3
20.0		! 4 Initial Tank Temperature-4
20.0		! 5 Initial Tank Temperature-5
*------------------------------------------------------------------------------

* Model "Load_Tout-9" (Type 22)
* 

UNIT 206 TYPE 22	 Load_Tout-9
*$UNIT_NAME Load_Tout-9
*$MODEL .\Controllers\Iterative Feedback Controller\Type22.tmf
*$POSITION 635 7418
*$LAYER Main # 
PARAMETERS 2
0		! 1 mode
0		! 2 Maximum number of oscillations
INPUTS 7
Tload_10		! DHW flow_demand-9:Tload_10 ->Setpoint
205,1 		! AF3000-9:Temperature at outlet ->Controlled variable
0,0		! [unconnected] On / Off signal
0,0		! [unconnected] Minimum control signal
0,0		! [unconnected] Maximum control signal
0,0		! [unconnected] Threshold for non-zero output
0,0		! [unconnected] Tolerance on tracking error
*** INITIAL INPUT VALUES
58 0 1 0 1 0 0 
*------------------------------------------------------------------------------

* Model "PreheatFreshWater-9" (Type 91)
* 

UNIT 207 TYPE 91	 PreheatFreshWater-9
*$UNIT_NAME PreheatFreshWater-9
*$MODEL .\Heat Exchangers\Constant Effectiveness\Type91.tmf
*$POSITION 270 7645
*$LAYER Main # 
PARAMETERS 3
0		! 1 Heat exchanger effectiveness
4.19		! 2 Specific heat of source side fluid
4.19		! 3 Specific heat of load side fluid
INPUTS 4
TankTempHot_10		! Heat _from_CHP-9:TankTempHot_10 ->Source side inlet temperature
TankFR_Hot_10		! Heat _from_CHP-9:TankFR_Hot_10 ->Source side flow rate
Tcold_10		! DHW flow_demand-9:Tcold_10 ->Load side inlet temperature
Demand_FR_10		! DHW flow_demand-9:Demand_FR_10 ->Load side flow rate
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------

END
